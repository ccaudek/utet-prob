<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>14&nbsp; Distribuzioni di v.c. discrete – Probabilità per la psicologia — Modulo di richiamo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/probability/14_cont_rv_distr.html" rel="next">
<link href="../../chapters/probability/12_intro_distributions.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/probability/introduction_probability.html">Probabilità</a></li><li class="breadcrumb-item"><a href="../../chapters/probability/13_discr_rv_distr.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Probabilità per la psicologia — Modulo di richiamo</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/utet-prob/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percorso e obiettivi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefazione</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: la <span class="math inline">\(\sigma\)</span>-algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11_cov_cor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Covarianza e correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_intro_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_discr_rv_distr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/16_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">14.1</span> Introduzione</a></li>
  <li><a href="#distribuzioni-in-r" id="toc-distribuzioni-in-r" class="nav-link" data-scroll-target="#distribuzioni-in-r"><span class="header-section-number">14.2</span> Distribuzioni in R</a></li>
  <li><a href="#distribuzione-uniforme-discreta-1" id="toc-distribuzione-uniforme-discreta-1" class="nav-link" data-scroll-target="#distribuzione-uniforme-discreta-1"><span class="header-section-number">14.3</span> Distribuzione Uniforme Discreta</a></li>
  <li><a href="#distribuzione-di-bernoulli-1" id="toc-distribuzione-di-bernoulli-1" class="nav-link" data-scroll-target="#distribuzione-di-bernoulli-1"><span class="header-section-number">14.4</span> Distribuzione di Bernoulli</a></li>
  <li><a href="#distribuzione-binomiale-1" id="toc-distribuzione-binomiale-1" class="nav-link" data-scroll-target="#distribuzione-binomiale-1"><span class="header-section-number">14.5</span> Distribuzione Binomiale</a></li>
  <li><a href="#funzioni-r-per-le-distribuzioni-di-probabilit%C3%A0" id="toc-funzioni-r-per-le-distribuzioni-di-probabilità" class="nav-link" data-scroll-target="#funzioni-r-per-le-distribuzioni-di-probabilit%C3%A0"><span class="header-section-number">14.6</span> Funzioni R per le distribuzioni di probabilità</a></li>
  <li><a href="#distribuzione-di-poisson-1" id="toc-distribuzione-di-poisson-1" class="nav-link" data-scroll-target="#distribuzione-di-poisson-1"><span class="header-section-number">14.7</span> Distribuzione di Poisson</a></li>
  <li><a href="#distribuzione-beta-binomiale" id="toc-distribuzione-beta-binomiale" class="nav-link" data-scroll-target="#distribuzione-beta-binomiale"><span class="header-section-number">14.8</span> Distribuzione Beta-Binomiale</a></li>
  <li><a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">14.9</span> Riflessioni Conclusive</a></li>
  <li><a href="#esercitazione-in-classe" id="toc-esercitazione-in-classe" class="nav-link" data-scroll-target="#esercitazione-in-classe"><span class="header-section-number">14.10</span> Esercitazione in Classe</a></li>
  <li><a href="#esercizi" id="toc-esercizi" class="nav-link" data-scroll-target="#esercizi">Esercizi</a></li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/utet-prob/blob/main/chapters/probability/13_discr_rv_distr.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-prob/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/probability/introduction_probability.html">Probabilità</a></li><li class="breadcrumb-item"><a href="../../chapters/probability/13_discr_rv_distr.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-prob-discrete-prob-distr" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>comprendere le principali distribuzioni di massa di probabilità;</li>
<li>utilizzare R per manipolare e analizzare queste distribuzioni.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Random variables and their distributions</em> del testo di <span class="citation" data-cites="blitzstein2019introduction">Blitzstein &amp; Hwang (<a href="#ref-blitzstein2019introduction" role="doc-biblioref">2019</a>)</span>.</li>
<li>Leggere il capitolo <em>Special Distributions</em> <span class="citation" data-cites="schervish2014probability">(<a href="#ref-schervish2014probability" role="doc-biblioref">Schervish &amp; DeGroot, 2014</a>)</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">reshape2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">14.1</span> Introduzione</h2>
<p>È importante distinguere tra variabili casuali discrete e continue, perché le distribuzioni di probabilità associate sono molto diverse nei due casi <a href="06_random_var.html" class="quarto-xref">si veda il&nbsp;<span>7</span></a>.</p>
<p>In questo capitolo ci focalizzeremo sulle <strong>distribuzioni di probabilità discrete</strong>, strumenti fondamentali per modellare fenomeni aleatori che generano un numero finito o numerabile di possibili esiti. Queste distribuzioni risultano particolarmente efficaci per descrivere eventi che si verificano in contesti discreti, come il numero di successi in un esperimento, l’occorrenza di un evento, o la selezione casuale da un insieme di opzioni finite.</p>
<section id="panoramica-delle-distribuzioni-discrete" class="level3" data-number="14.1.1"><h3 data-number="14.1.1" class="anchored" data-anchor-id="panoramica-delle-distribuzioni-discrete">
<span class="header-section-number">14.1.1</span> Panoramica delle Distribuzioni Discrete</h3>
<p>Di seguito, vengono presentate alcune delle principali distribuzioni discrete utilizzate in statistica e nella ricerca psicologica Ogni distribuzione è descritta in termini di caratteristiche fondamentali, applicazioni pratiche e importanza teorica.</p>
<section id="distribuzione-uniforme-discreta" class="level4" data-number="14.1.1.1"><h4 data-number="14.1.1.1" class="anchored" data-anchor-id="distribuzione-uniforme-discreta">
<span class="header-section-number">14.1.1.1</span> Distribuzione Uniforme Discreta</h4>
<ul>
<li>
<strong>Descrizione</strong>: La distribuzione uniforme discreta rappresenta situazioni in cui tutti gli eventi all’interno di un insieme finito hanno la stessa probabilità di verificarsi.</li>
<li>
<strong>Applicazioni</strong>: Si applica in contesti di scelta casuale equiprobabile, come:
<ul>
<li>La selezione casuale di uno stimolo da una lista di parole in un esperimento di memoria.</li>
<li>L’assegnazione casuale di partecipanti a gruppi sperimentali in uno studio di psicologia sociale.</li>
<li>La scelta di un’immagine tra un insieme di stimoli visivi in una ricerca sull’attenzione.</li>
<li>La probabilità uniforme che un partecipante scelga una delle opzioni in un questionario a risposte multiple, in assenza di preferenze o conoscenze specifiche.</li>
</ul>
</li>
<li>
<strong>Parametri</strong>:
<ul>
<li>Intervallo di supporto: l’insieme finito di valori possibili (ad esempio, <span class="math inline">\(\{1, 2, \dots, k\}\)</span>).</li>
</ul>
</li>
<li>
<strong>Importanza</strong>: Funziona come modello di riferimento in situazioni di massima incertezza o mancanza di preferenze. È utile per definire un punto di partenza in analisi più complesse e per studiare comportamenti casuali.</li>
</ul></section><section id="distribuzione-di-bernoulli" class="level4" data-number="14.1.1.2"><h4 data-number="14.1.1.2" class="anchored" data-anchor-id="distribuzione-di-bernoulli">
<span class="header-section-number">14.1.1.2</span> Distribuzione di Bernoulli</h4>
<ul>
<li>
<strong>Descrizione</strong>: La distribuzione di Bernoulli modella esperimenti con due possibili esiti, generalmente etichettati come “successo” (con probabilità <span class="math inline">\(p\)</span>) e “fallimento” (con probabilità <span class="math inline">\(1-p\)</span>).</li>
<li>
<strong>Applicazioni</strong>: Si applica a situazioni binarie, come il lancio di una moneta (testa/croce), la risposta a domande dicotomiche (sì/no), o l’esito di un evento che può verificarsi o meno.</li>
<li>
<strong>Parametro</strong>:
<ul>
<li>
<span class="math inline">\(p\)</span>: probabilità di successo.</li>
</ul>
</li>
<li>
<strong>Importanza</strong>: Costituisce la base per molte altre distribuzioni discrete, come la distribuzione binomiale e geometrica. È fondamentale per comprendere fenomeni con esiti dichotomici.</li>
</ul></section><section id="distribuzione-binomiale" class="level4" data-number="14.1.1.3"><h4 data-number="14.1.1.3" class="anchored" data-anchor-id="distribuzione-binomiale">
<span class="header-section-number">14.1.1.3</span> Distribuzione Binomiale</h4>
<ul>
<li>
<strong>Descrizione</strong>: La distribuzione binomiale descrive il numero totale di successi in un numero fisso <span class="math inline">\(n\)</span> di prove indipendenti, ciascuna governata da una distribuzione di Bernoulli con probabilità di successo <span class="math inline">\(p\)</span>.</li>
<li>
<strong>Applicazioni</strong>: Viene utilizzata per analizzare processi ripetuti con esiti binari, ad esempio:
<ul>
<li>Il numero di voti favorevoli in un campione di opinione.</li>
<li>Il numero di sintomi osservati in un gruppo di pazienti.</li>
<li>Il conteggio di errori in un test di accuratezza.</li>
</ul>
</li>
<li>
<strong>Parametri</strong>:
<ul>
<li>
<span class="math inline">\(n\)</span>: numero di prove.</li>
<li>
<span class="math inline">\(p\)</span>: probabilità di successo in ogni prova.</li>
</ul>
</li>
<li>
<strong>Importanza</strong>: Fornisce uno strumento essenziale per modellare fenomeni ripetuti in condizioni identiche, consentendo analisi probabilistiche avanzate e previsioni statistiche.</li>
</ul></section><section id="distribuzione-di-poisson" class="level4" data-number="14.1.1.4"><h4 data-number="14.1.1.4" class="anchored" data-anchor-id="distribuzione-di-poisson">
<span class="header-section-number">14.1.1.4</span> Distribuzione di Poisson</h4>
<ul>
<li>
<strong>Descrizione</strong>: La distribuzione di Poisson modella il numero di eventi che si verificano in un intervallo fissato di tempo o spazio, quando tali eventi sono rari, indipendenti e accadono a un tasso medio costante <span class="math inline">\(\lambda\)</span>.</li>
<li>
<strong>Applicazioni</strong>: Trova impiego in contesti dove gli eventi sono sporadici ma prevedibili, ad esempio:
<ul>
<li>Il numero di episodi di ansia riportati in una settimana.</li>
<li>Il numero di interazioni sociali spontanee di un bambino con disturbo dello spettro autistico durante una sessione di osservazione.</li>
<li>La frequenza di lapsus verbali durante una presentazione pubblica.</li>
<li>Il numero di sogni vividi riportati durante una serie di notti consecutive in uno studio sul sonno.</li>
</ul>
</li>
<li>
<strong>Parametro</strong>:
<ul>
<li>
<span class="math inline">\(\lambda\)</span>: tasso medio di eventi per unità di tempo o spazio.</li>
</ul>
</li>
<li>
<strong>Importanza</strong>: È cruciale per analizzare fenomeni psicologici o comportamentali rari ma significativi. Aiuta a comprendere i meccanismi sottostanti e a modellare la variabilità osservata in contesti clinici, sperimentali o quotidiani.</li>
</ul>
<p>In conclusione, le distribuzioni discrete sopra descritte rappresentano strumenti fondamentali per modellare una vasta gamma di fenomeni osservati in ambito scientifico, psicologico e applicativo. Ciascuna distribuzione offre una cornice teorica ben definita per interpretare e analizzare situazioni caratterizzate da variabili aleatorie discrete, fornendo così le basi per inferenze statistiche robuste e previsioni quantitative affidabili.</p>
</section></section></section><section id="distribuzioni-in-r" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="distribuzioni-in-r">
<span class="header-section-number">14.2</span> Distribuzioni in R</h2>
<p>In R, per ogni distribuzione sono disponibili quattro funzioni principali, i cui nomi iniziano con le lettere:</p>
<ul>
<li>
<strong>d</strong> (<em>density</em>): per calcolare i valori teorici relativi alla distribuzione,<br>
</li>
<li>
<strong>p</strong> (<em>probability</em>): per ottenere la probabilità cumulativa,<br>
</li>
<li>
<strong>q</strong> (<em>quantile</em>): per determinare i quantili,<br>
</li>
<li>
<strong>r</strong> (<em>random</em>): per generare campioni casuali.</li>
</ul>
<p>Il pacchetto di base <code>stats</code> include numerose funzioni dedicate alle principali distribuzioni statistiche, permettendo di calcolare valori teorici e simulare dati in modo semplice e flessibile. Per ulteriori dettagli sulle distribuzioni disponibili e sull’uso delle relative funzioni, è possibile consultare la documentazione con il comando <code><a href="https://rdrr.io/r/stats/Distributions.html">?Distributions</a></code>.</p>
</section><section id="distribuzione-uniforme-discreta-1" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="distribuzione-uniforme-discreta-1">
<span class="header-section-number">14.3</span> Distribuzione Uniforme Discreta</h2>
<p>La <strong>distribuzione uniforme discreta</strong> è una delle più semplici e intuitive distribuzioni di probabilità. È utilizzata per modellare situazioni in cui <strong>tutti gli esiti possibili sono ugualmente probabili</strong>. Si applica, ad esempio, quando si estrae un numero a caso da un insieme finito di interi senza alcuna preferenza.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definizione 14.1</strong></span> Sia <span class="math inline">\(X\)</span> una variabile casuale che può assumere i valori interi da 1 a <span class="math inline">\(N\)</span>, tutti con la <strong>stessa probabilità</strong>. Allora diciamo che <span class="math inline">\(X\)</span> ha una distribuzione uniforme discreta sull’intervallo <span class="math inline">\(\{1, 2, \dots, N\}\)</span>. In simboli:</p>
<p><span class="math display">\[
X \sim \text{Uniforme Discreta}(1, N) .
\]</span></p>
<p>Poiché ci sono <span class="math inline">\(N\)</span> valori possibili e ciascuno ha la stessa probabilità, ogni valore ha probabilità:</p>
<p><span class="math display">\[
P(X = x) = \frac{1}{N}, \quad \text{per } x \in \{1, 2, \dots, N\}.
\]</span></p>
</div>
<section id="proprietà-di-normalizzazione" class="level3" data-number="14.3.1"><h3 data-number="14.3.1" class="anchored" data-anchor-id="proprietà-di-normalizzazione">
<span class="header-section-number">14.3.1</span> Proprietà di normalizzazione</h3>
<p>La somma delle probabilità di tutti gli esiti deve essere pari a 1:</p>
<p><span class="math display">\[
\sum_{x = 1}^{N} P(X = x) = \sum_{x = 1}^{N} \frac{1}{N} = \frac{1}{N} \cdot N = 1.
\]</span></p>
<p>Questa è una proprietà fondamentale di ogni distribuzione di probabilità.</p>
</section><section id="valore-atteso" class="level3" data-number="14.3.2"><h3 data-number="14.3.2" class="anchored" data-anchor-id="valore-atteso">
<span class="header-section-number">14.3.2</span> Valore atteso</h3>
<p>Il <strong>valore atteso</strong> (o media) ci dice qual è il risultato medio atteso nel lungo periodo. Si calcola come:</p>
<p><span class="math display">\[
\mathbb{E}(X) = \sum_{x = 1}^{N} x \cdot P(X = x) = \frac{1}{N} \sum_{x = 1}^{N} x.
\]</span></p>
<p>La somma dei primi <span class="math inline">\(N\)</span> numeri naturali è:</p>
<p><span class="math display">\[
\sum_{x = 1}^{N} x = \frac{N(N + 1)}{2}.
\]</span></p>
<p>Quindi:</p>
<p><span class="math display">\[
\mathbb{E}(X) = \frac{1}{N} \cdot \frac{N(N + 1)}{2} = \frac{N + 1}{2}.
\]</span></p>
<p>In conclusione, il valore atteso di una variabile uniforme discreta su <span class="math inline">\(\{1, \dots, N\}\)</span> è <span class="math inline">\(\frac{N + 1}{2}\)</span>.</p>
</section><section id="varianza" class="level3" data-number="14.3.3"><h3 data-number="14.3.3" class="anchored" data-anchor-id="varianza">
<span class="header-section-number">14.3.3</span> Varianza</h3>
<p>La varianza della distribuzione uniforme discreta è:</p>
<p><span class="math display">\[
\mathbb{V}(X) = \frac{(N + 1)(N - 1)}{12}.
\]</span></p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Dimostrazione">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dimostrazione
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La <strong>varianza</strong> misura quanto i valori di <span class="math inline">\(X\)</span> si discostano in media dalla media <span class="math inline">\(\mathbb{E}(X)\)</span>. Si calcola come:</p>
<p><span class="math display">\[
\mathbb{V}(X) = \mathbb{E}(X^2) - \left[\mathbb{E}(X)\right]^2.
\]</span></p>
<ol type="1">
<li>Calcolo di <span class="math inline">\(\mathbb{E}(X^2)\)</span>.</li>
</ol>
<p>Poiché tutti i valori hanno la stessa probabilità <span class="math inline">\(\frac{1}{N}\)</span>, otteniamo:</p>
<p><span class="math display">\[
\mathbb{E}(X^2) = \frac{1}{N} \sum_{x = 1}^{N} x^2.
\]</span></p>
<p>La somma dei quadrati dei primi <span class="math inline">\(N\)</span> interi è:</p>
<p><span class="math display">\[
\sum_{x = 1}^{N} x^2 = \frac{N(N + 1)(2N + 1)}{6}
\]</span></p>
<p>(per una dimostrazione, si veda la <a href="https://it.wikipedia.org/wiki/Numero_piramidale_quadrato">pagina di Wikipedia sui numeri piramidali quadrati</a>).</p>
<p>Quindi:</p>
<p><span class="math display">\[
\mathbb{E}(X^2) = \frac{1}{N} \cdot \frac{N(N + 1)(2N + 1)}{6} = \frac{(N + 1)(2N + 1)}{6}.
\]</span></p>
<ol start="2" type="1">
<li>Calcolo della varianza.</li>
</ol>
<p>Sostituendo nella formula della varianza:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}(X) &amp;= \frac{(N + 1)(2N + 1)}{6} - \left(\frac{N + 1}{2}\right)^2 \\
&amp;= \frac{(N + 1)(2N + 1)}{6} - \frac{(N + 1)^2}{4}
\end{aligned}
\]</span></p>
<p>Per semplificare, portiamo tutto allo stesso denominatore:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}(X) &amp;= \frac{2(N + 1)(2N + 1)}{12} - \frac{3(N + 1)^2}{12} \\
&amp;= \frac{(N + 1) \left[2(2N + 1) - 3(N + 1)\right]}{12} \\
&amp;= \frac{(N + 1)(4N + 2 - 3N - 3)}{12} \\
&amp;= \frac{(N + 1)(N - 1)}{12}.
\end{aligned}
\]</span></p>
<p>In conclusione, la varianza della distribuzione uniforme discreta è:</p>
<p><span class="math display">\[
\mathbb{V}(X) = \frac{(N + 1)(N - 1)}{12}.
\]</span></p>
</div>
</div>
</div>
<p><strong>In sintesi</strong>, per una variabile casuale <span class="math inline">\(X\)</span> uniformemente distribuita su <span class="math inline">\(\{1, 2, \dots, N\}\)</span>:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Proprietà</th>
<th>Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Media</td>
<td><span class="math inline">\(\mathbb{E}(X) = \dfrac{N + 1}{2}\)</span></td>
</tr>
<tr class="even">
<td>Varianza</td>
<td><span class="math inline">\(\mathbb{V}(X) = \dfrac{(N + 1)(N - 1)}{12}\)</span></td>
</tr>
</tbody>
</table>
<p>Questa distribuzione è utile ogni volta che <strong>non c’è alcuna ragione per preferire un valore a un altro</strong> all’interno di un insieme finito di numeri interi.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.1</strong></span> Supponiamo che <span class="math inline">\(X\)</span> sia una variabile casuale con distribuzione uniforme discreta tra 1 e 10, ovvero:</p>
<p><span class="math display">\[
X \sim \text{Uniforme Discreta}(1, 10) .
\]</span></p>
<p>Vogliamo:</p>
<ol type="1">
<li>generare un grande campione casuale,</li>
<li>calcolare la media e la varianza osservate,</li>
<li>confrontarle con i valori teorici.</li>
</ol>
<p><strong>Codice R.</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># Per rendere la simulazione riproducibile</span></span>
<span></span>
<span><span class="co"># Parametro N</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Simulazione: 100.000 osservazioni dalla distribuzione uniforme discreta</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, size <span class="op">=</span> <span class="fl">100000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Media e varianza empiriche</span></span>
<span><span class="va">media_empirica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">varianza_empirica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Valori teorici</span></span>
<span><span class="va">media_teorica</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">N</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">varianza_teorica</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">N</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">12</span></span>
<span></span>
<span><span class="co"># Risultati</span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  `Media empirica` <span class="op">=</span> <span class="va">media_empirica</span>,</span>
<span>  `Media teorica` <span class="op">=</span> <span class="va">media_teorica</span>,</span>
<span>  `Varianza empirica` <span class="op">=</span> <span class="va">varianza_empirica</span>,</span>
<span>  `Varianza teorica` <span class="op">=</span> <span class="va">varianza_teorica</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;   `Media empirica` `Media teorica` `Varianza empirica` `Varianza teorica`</span></span>
<span><span class="co">#&gt;              &lt;dbl&gt;           &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1             5.51             5.5                8.26               8.25</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con un campione molto grande, le <strong>statistiche empiriche</strong> (cioè calcolate dai dati simulati) saranno molto vicine ai <strong>valori teorici</strong>:</p>
<table class="caption-top table">
<thead><tr class="header">
<th></th>
<th>Valore</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Media teorica</td>
<td>5.5</td>
</tr>
<tr class="even">
<td>Media empirica</td>
<td>≈ 5.5</td>
</tr>
<tr class="odd">
<td>Varianza teorica</td>
<td>8.25</td>
</tr>
<tr class="even">
<td>Varianza empirica</td>
<td>≈ 8.25</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>In sintesi</strong>, a simulazione conferma che:</p>
<ul>
<li>la media empirica converge verso <span class="math inline">\(\mathbb{E}(X) = \frac{N + 1}{2}\)</span>,</li>
<li>la varianza empirica converge verso <span class="math inline">\(\mathbb{V}(X) = \frac{(N + 1)(N - 1)}{12}\)</span>.</li>
</ul>
</div>
</section></section><section id="distribuzione-di-bernoulli-1" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="distribuzione-di-bernoulli-1">
<span class="header-section-number">14.4</span> Distribuzione di Bernoulli</h2>
<p>In statistica, un esperimento che ammette solo due esiti possibili è modellato attraverso quella che viene chiamata “prova Bernoulliana”. Un esempio tipico è il lancio di una moneta, che può dare come risultato testa o croce.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definizione 14.2</strong></span> Una variabile casuale <span class="math inline">\(X\)</span> che assume valori in <span class="math inline">\(\{0, 1\}\)</span> è detta variabile di Bernoulli. La sua distribuzione di probabilità è definita come:</p>
<p><span class="math display">\[
P(X \mid \theta) =
  \begin{cases}
    p     &amp; \text{se $X = 1$ (successo)}, \\
    1 - p &amp; \text{se $X = 0$ (insuccesso)},
  \end{cases}
\]</span></p>
<p>dove <span class="math inline">\(0 \leq p \leq 1\)</span>. Il parametro <span class="math inline">\(p\)</span> rappresenta la probabilità del “successo” (<span class="math inline">\(X = 1\)</span>), mentre <span class="math inline">\(1 - p\)</span> è la probabilità dell’“insuccesso” (<span class="math inline">\(X = 0\)</span>).</p>
</div>
<p>La distribuzione di Bernoulli descrive quindi un contesto in cui la probabilità di osservare l’esito 1 è <span class="math inline">\(p\)</span> e quella di osservare l’esito 0 è <span class="math inline">\(1 - p\)</span>. Viene utilizzata per modellare situazioni binarie, come una risposta “sì” o “no”, oppure un “successo” o “insuccesso”.</p>
<p>Calcolando il valore atteso e la varianza, otteniamo:</p>
<p><span id="eq-ev-var-bern"><span class="math display">\[
\begin{aligned}
\mathbb{E}(X) &amp;= 0 \cdot P(X=0) + 1 \cdot P(X=1) = p, \\
\mathbb{V}(X) &amp;= (0 - p)^2 \cdot P(X=0) + (1 - p)^2 \cdot P(X=1) = p(1-p).
\end{aligned}
\tag{14.1}\]</span></span></p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dimostrazione
</div>
</div>
<div class="callout-body-container callout-body">
<p>Esaminiamo la dimostrazione algebrica del calcolo della varianza.</p>
<p>Espandiamo il calcolo della somma, considerando i due possibili valori di <span class="math inline">\(X\)</span> (0 e 1).</p>
<ol type="1">
<li>
<p><strong>Primo termine (<span class="math inline">\(X = 0\)</span>):</strong></p>
<p><span class="math display">\[
(0 - \mathbb{E}(X))^2 \cdot P(X = 0) = (0 - p)^2 \cdot (1 - p).
\]</span></p>
<p>Semplificando <span class="math inline">\((0 - p)^2 = p^2\)</span>, quindi:</p>
<p><span class="math display">\[
(0 - \mathbb{E}(X))^2 \cdot P(X = 0) = p^2 \cdot (1 - p).
\]</span></p>
</li>
<li>
<p><strong>Secondo termine (<span class="math inline">\(X = 1\)</span>):</strong></p>
<p><span class="math display">\[
(1 - \mathbb{E}(X))^2 \cdot P(X = 1) = (1 - p)^2 \cdot p.
\]</span></p>
<p>Semplificando <span class="math inline">\((1 - p)^2 = 1 - 2p + p^2\)</span>, quindi:</p>
<p><span class="math display">\[
(1 - \mathbb{E}(X))^2 \cdot P(X = 1) = (1 - 2p + p^2) \cdot p = p - 2p^2 + p^3.
\]</span></p>
</li>
<li>
<p><strong>Somma dei termini</strong></p>
<p>Ora sommiamo i due contributi:</p>
<p><span class="math display">\[
\mathbb{V}(X) = p^2 \cdot (1 - p) + (p - 2p^2 + p^3).
\]</span></p>
<p>Espandendo il primo termine:</p>
<p><span class="math display">\[
p^2 \cdot (1 - p) = p^2 - p^3.
\]</span></p>
<p>Somma completa:</p>
<p><span class="math display">\[
\mathbb{V}(X) = (p^2 - p^3) + (p - 2p^2 + p^3).
\]</span></p>
</li>
<li>
<p><strong>Raggruppiamo i termini</strong></p>
<p><span class="math display">\[
\mathbb{V}(X) = p - p^2.
\]</span></p>
<p><strong>Risultato finale:</strong></p>
<p><span class="math display">\[
\mathbb{V}(X) = p(1 - p).
\]</span></p>
</li>
</ol>
<p>In sintesi, la varianza di una variabile aleatoria binaria <span class="math inline">\(X\)</span>, distribuita secondo Bernoulli con parametro <span class="math inline">\(p\)</span>, è data da <span class="math inline">\(p(1-p)\)</span>.</p>
</div>
</div>
<p>Tale risultato mostra come la varianza massima si ottenga per <span class="math inline">\(p = 0.5\)</span>, condizione che corrisponde alla massima incertezza intrinseca nel processo, ossia quando la probabilità di successo eguaglia quella di insuccesso.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Valori di p tra 0 e 1</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, Variance <span class="op">=</span> <span class="va">variance</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creazione del grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p</span>, y <span class="op">=</span> <span class="va">Variance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Varianza"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<section id="notazione" class="level3" data-number="14.4.1"><h3 data-number="14.4.1" class="anchored" data-anchor-id="notazione">
<span class="header-section-number">14.4.1</span> Notazione</h3>
<p>Per indicare che la variabile casuale <span class="math inline">\(X\)</span> segue una distribuzione Bernoulliana di parametro <span class="math inline">\(p\)</span> Utilizziamo la notazione <span class="math inline">\(X \sim \mathcal{Bern}(p)\)</span>, o in maniera equivalente <span class="math inline">\(\mathcal{Bern}(X \mid p)\)</span>.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.2</strong></span> Nel caso del lancio di una moneta equilibrata, la variabile di Bernoulli assume i valori <span class="math inline">\(0\)</span> e <span class="math inline">\(1\)</span> con uguale probabilità di <span class="math inline">\(\frac{1}{2}\)</span>. Pertanto, la funzione di massa di probabilità assegna una probabilità di <span class="math inline">\(\frac{1}{2}\)</span> sia per <span class="math inline">\(X = 0\)</span> che per <span class="math inline">\(X = 1\)</span>, mentre la funzione di distribuzione cumulativa risulta essere <span class="math inline">\(\frac{1}{2}\)</span> per <span class="math inline">\(X = 0\)</span> e <span class="math inline">\(1\)</span> per <span class="math inline">\(X = 1\)</span>.</p>
<p>Generiamo dei valori casuali dalla distribuzione di Bernoulli. Iniziamo con un singolo valore:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Probabilità di successo</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Genera un singolo valore</span></span>
<span><span class="va">bernoulli_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bernoulli_sample</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="co"># Genera un campione di 10 valori</span></span>
<span><span class="va">bernoulli_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bernoulli_sample</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0 1 0 1 0 0 0 1 0 0</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section><section id="distribuzione-binomiale-1" class="level2" data-number="14.5"><h2 data-number="14.5" class="anchored" data-anchor-id="distribuzione-binomiale-1">
<span class="header-section-number">14.5</span> Distribuzione Binomiale</h2>
<p>La distribuzione binomiale è una distribuzione di probabilità discreta che modella il numero di successi <span class="math inline">\(y\)</span> in un numero fissato <span class="math inline">\(n\)</span> di prove di Bernoulli indipendenti e identiche, dove ciascuna prova ha solo due esiti possibili: “successo” (rappresentato da “1”) con probabilità <span class="math inline">\(p\)</span> o “insuccesso” (rappresentato da “0”) con probabilità <span class="math inline">\(1 - p\)</span>. La notazione utilizzata è la seguente:</p>
<p><span class="math display">\[
Y \sim \mathcal{Binom}(n, p).
\]</span></p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definizione 14.3</strong></span> La distribuzione binomiale descrive la probabilità di osservare esattamente <span class="math inline">\(y\)</span> successi in <span class="math inline">\(n\)</span> prove di Bernoulli indipendenti:</p>
<p><span id="eq-binom-distr"><span class="math display">\[
P(Y = y) = \binom{n}{y} p^{y} (1 - p)^{n - y} = \frac{n!}{y!(n - y)!} p^{y} (1 - p)^{n - y},
\tag{14.2}\]</span></span></p>
<p>dove <span class="math inline">\(\binom{n}{y}\)</span>, noto come coefficiente binomiale, rappresenta il numero di modi possibili per ottenere <span class="math inline">\(y\)</span> successi in <span class="math inline">\(n\)</span> prove, e <span class="math inline">\(p\)</span> è la probabilità di successo in ciascuna prova.</p>
</div>
<p>La distribuzione binomiale si presta bene a esempi classici come il lancio ripetuto di una moneta o l’estrazione di biglie da un’urna. Ad esempio, nel caso del lancio di una moneta, questa distribuzione descrive la probabilità di ottenere un determinato numero di “teste” in un certo numero di lanci, con ogni lancio che segue una distribuzione di Bernoulli con probabilità di successo <span class="math inline">\(p\)</span>.</p>
<p>Una caratteristica interessante della distribuzione binomiale è la sua <em>proprietà di riproducibilità</em>: se due variabili casuali indipendenti, <span class="math inline">\(y_1\)</span> e <span class="math inline">\(y_2\)</span>, seguono entrambe distribuzioni binomiali con lo stesso parametro <span class="math inline">\(p\)</span>, ma con un diverso numero di prove (<span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span>), la loro somma, <span class="math inline">\(y = y_1 + y_2\)</span>, sarà ancora distribuita binomialmente, con parametri <span class="math inline">\(n_1 + n_2\)</span> e <span class="math inline">\(p\)</span>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dimostrazione
</div>
</div>
<div class="callout-body-container callout-body">
<p>Per chiarire il calcolo delle probabilità nella <strong>distribuzione binomiale</strong>, consideriamo una serie di prove di <strong>Bernoulli</strong>. Supponiamo di avere <span class="math inline">\(n\)</span> prove indipendenti, ciascuna con probabilità <span class="math inline">\(p\)</span> di successo, e di osservare esattamente <span class="math inline">\(y\)</span> successi.</p>
<p>Una possibile configurazione dei risultati può essere rappresentata come:</p>
<p><span class="math display">\[
\overbrace{SS\dots S}^\text{$y$ successi} \, \overbrace{II\dots I}^\text{$n - y$ insuccessi}
\]</span></p>
<p>La probabilità di ottenere <strong>esattamente <span class="math inline">\(y\)</span> successi in una sequenza specifica</strong> (cioè in un ordine fissato) è:</p>
<p><span class="math display">\[
p^y \cdot (1 - p)^{n - y},
\]</span></p>
<p>dove <span class="math inline">\(p^y\)</span> è la probabilità dei <span class="math inline">\(y\)</span> successi e <span class="math inline">\((1 - p)^{n - y}\)</span> quella dei <span class="math inline">\(n - y\)</span> insuccessi.</p>
<p>Tuttavia, ciò che ci interessa è la <strong>probabilità complessiva</strong> di ottenere <span class="math inline">\(y\)</span> successi in <em>qualsiasi ordine</em>. In altre parole, vogliamo calcolare la probabilità dell’<strong>unione</strong> di tutte le possibili sequenze di <span class="math inline">\(n\)</span> prove che contengono esattamente <span class="math inline">\(y\)</span> successi.</p>
<p>Il numero di tali sequenze è dato dal <strong>coefficiente binomiale</strong> <span class="math inline">\(\binom{n}{y}\)</span>, che rappresenta il numero di modi diversi in cui possiamo scegliere le <span class="math inline">\(y\)</span> posizioni dei successi tra le <span class="math inline">\(n\)</span> prove.</p>
<p>Moltiplicando la probabilità di una singola sequenza per il numero totale di sequenze possibili, otteniamo la <strong>funzione di probabilità della distribuzione binomiale</strong>:</p>
<p><span class="math display">\[
P(Y = y) = \binom{n}{y} p^y (1 - p)^{n - y}.
\]</span></p>
</div>
</div>
<section id="caso-particolare-n-1" class="level3" data-number="14.5.1"><h3 data-number="14.5.1" class="anchored" data-anchor-id="caso-particolare-n-1">
<span class="header-section-number">14.5.1</span> Caso particolare <span class="math inline">\(n = 1\)</span>
</h3>
<p>Ora consideriamo il caso particolare in cui <span class="math inline">\(n = 1\)</span>. Quando <span class="math inline">\(n = 1\)</span>, il coefficiente binomiale diventa:</p>
<p><span class="math display">\[
\binom{1}{y} = \frac{1!}{y! (1-y)!}.
\]</span></p>
<p>Espandiamo i fattoriali per i due possibili valori di <span class="math inline">\(y\)</span>, che può assumere solo 0 o 1 (poiché <span class="math inline">\(y \in \{0, 1, \dots, n\}\)</span>).</p>
<p><strong>Caso 1: <span class="math inline">\(y = 0\)</span></strong></p>
<p><span class="math display">\[
\binom{1}{0} = \frac{1!}{0! (1-0)!} = \frac{1}{1 \cdot 1} = 1.
\]</span></p>
<p>Quindi, per <span class="math inline">\(y = 0\)</span>: <span class="math display">\[
P(Y = 0) = \binom{1}{0} p^0 (1-p)^{1-0} = 1 \cdot 1 \cdot (1-p) = 1-p.
\]</span></p>
<p><strong>Caso 2: <span class="math inline">\(y = 1\)</span></strong></p>
<p><span class="math display">\[
\binom{1}{1} = \frac{1!}{1! (1-1)!} = \frac{1}{1 \cdot 1} = 1.
\]</span></p>
<p>Quindi, per <span class="math inline">\(y = 1\)</span>: <span class="math display">\[
P(Y = 1) = \binom{1}{1} p^1 (1-p)^{1-1} = 1 \cdot p \cdot 1 = p.
\]</span></p>
<p>In conclusione, la PMF per la distribuzione binomiale con <span class="math inline">\(n = 1\)</span> diventa:</p>
<p><span class="math display">\[
P(Y = y) =
\begin{cases}
1-p, &amp; \text{se } y = 0, \\
p, &amp; \text{se } y = 1.
\end{cases}
\]</span></p>
<p>Questa è esattamente la PMF della distribuzione di Bernoulli con parametro <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
P(Y = y) = p^y (1-p)^{1-y}, \quad y \in \{0, 1\}.
\]</span></p>
<p>Pertanto, la distribuzione binomiale con <span class="math inline">\(n = 1\)</span> è equivalente alla distribuzione di Bernoulli con parametro <span class="math inline">\(p\)</span>.</p>
</section><section id="applicazioni-pratiche-della-distribuzione-binomiale" class="level3" data-number="14.5.2"><h3 data-number="14.5.2" class="anchored" data-anchor-id="applicazioni-pratiche-della-distribuzione-binomiale">
<span class="header-section-number">14.5.2</span> Applicazioni Pratiche della Distribuzione Binomiale</h3>
<p>Per illustrare l’applicazione della distribuzione binomiale, consideriamo un esempio semplice. Supponiamo di osservare <strong>2 successi su 4 prove di Bernoulli</strong>, dove la probabilità di successo in ogni prova è <span class="math inline">\(p = 0.2\)</span>. La probabilità di ottenere esattamente questo risultato si calcola con la formula:</p>
<p><span class="math display">\[
P(Y = 2) = \binom{4}{2} \cdot 0.2^2 \cdot (1 - 0.2)^{2} = 0.1536.
\]</span></p>
<p>In R, questo calcolo si può fare in modo diretto:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametri</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Calcolo della probabilità esatta</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="va">p</span><span class="op">^</span><span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.154</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In alternativa, possiamo usare la funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code> per ottenere la stessa probabilità:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.154</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualizzazione-della-distribuzione-di-probabilità" class="level4" data-number="14.5.2.1"><h4 data-number="14.5.2.1" class="anchored" data-anchor-id="visualizzazione-della-distribuzione-di-probabilità">
<span class="header-section-number">14.5.2.1</span> Visualizzazione della distribuzione di probabilità</h4>
<p>Possiamo rappresentare graficamente la <strong>distribuzione di massa di probabilità</strong> per tutti i possibili valori di <span class="math inline">\(y\)</span> da <span class="math inline">\(0\)</span> a <span class="math inline">\(n\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">y</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Successi <span class="op">=</span> <span class="va">y</span>, Probabilità <span class="op">=</span> <span class="va">probabilities</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Successi</span>, y <span class="op">=</span> <span class="va">Probabilità</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_segment</span><span class="op">(</span></span>
<span>      <span class="fu">aes</span><span class="op">(</span>xend <span class="op">=</span> <span class="va">Successi</span>, yend <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1.2</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Numero di successi y"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Probabilità"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="generazione-di-un-campione-casuale" class="level4" data-number="14.5.2.2"><h4 data-number="14.5.2.2" class="anchored" data-anchor-id="generazione-di-un-campione-casuale">
<span class="header-section-number">14.5.2.2</span> Generazione di un campione casuale</h4>
<p>La funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code> permette di generare un campione casuale da una distribuzione binomiale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 4 4 2 4 3 3 3 1 3 3 2 3 4 2 2 4 5 1 2 3 4 1 5 4 1 3 2 4 2 4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="variazione-della-distribuzione-al-variare-di-p" class="level4" data-number="14.5.2.3"><h4 data-number="14.5.2.3" class="anchored" data-anchor-id="variazione-della-distribuzione-al-variare-di-p">
<span class="header-section-number">14.5.2.3</span> Variazione della distribuzione al variare di <span class="math inline">\(p\)</span>
</h4>
<p>Per esplorare l’effetto di diversi valori di <span class="math inline">\(p\)</span> sulla forma della distribuzione, possiamo visualizzare più curve binomiali per <span class="math inline">\(n = 20\)</span> e <span class="math inline">\(p\)</span> variabile:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">25</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="va">p_values</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">binom_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">y</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, Prob <span class="op">=</span> <span class="va">binom_dist</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, y <span class="op">=</span> <span class="va">Prob</span>, color <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Numero di successi y"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Probabilità"</span>,</span>
<span>      color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="funzione-di-ripartizione-cumulativa" class="level4" data-number="14.5.2.4"><h4 data-number="14.5.2.4" class="anchored" data-anchor-id="funzione-di-ripartizione-cumulativa">
<span class="header-section-number">14.5.2.4</span> Funzione di ripartizione cumulativa</h4>
<p>Possiamo anche rappresentare la <strong>funzione di distribuzione cumulativa</strong> (CDF) per <span class="math inline">\(n = 5\)</span> e <span class="math inline">\(p = 0.5\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span></span>
<span></span>
<span><span class="va">cdf_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="va">y</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, cdf <span class="op">=</span> <span class="va">cdf_values</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, y <span class="op">=</span> <span class="va">cdf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span></span>
<span>      yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Numero di successi y"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Probabilità cumulativa"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.3</strong></span> Supponiamo di lanciare una <strong>moneta equa</strong> (cioè con probabilità <span class="math inline">\(p = 0.5\)</span> di ottenere testa) <strong>5 volte</strong>. Vogliamo calcolare la probabilità di ottenere <strong>almeno 2 teste</strong>, ovvero:</p>
<p><span class="math display">\[
P(Y \geq 2) = P(Y = 2) + P(Y = 3) + P(Y = 4) + P(Y = 5).
\]</span></p>
<p>Possiamo sommare direttamente queste probabilità usando <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.812</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Un modo alternativo, più efficiente, consiste nel calcolare il <strong>complemento</strong> della probabilità di ottenere <strong>meno di 2 teste</strong> (cioè 0 o 1):</p>
<p><span class="math display">\[
P(Y \geq 2) = 1 - P(Y \leq 1)
\]</span></p>
<p>In R, possiamo usare la funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> per calcolare questa probabilità cumulativa:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.812</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entrambi i metodi restituiscono lo stesso risultato numerico, ma il secondo è spesso preferibile quando <span class="math inline">\(n\)</span> è grande o quando si vuole calcolare una probabilità di coda.</p>
</div>
</section><section id="quantili-di-una-distribuzione-binomiale" class="level4" data-number="14.5.2.5"><h4 data-number="14.5.2.5" class="anchored" data-anchor-id="quantili-di-una-distribuzione-binomiale">
<span class="header-section-number">14.5.2.5</span> Quantili di una distribuzione binomiale</h4>
<p>Hai perfettamente ragione — grazie per l’osservazione!</p>
<p>Infatti, con i parametri <code>size = 5</code>, <code>prob = 0.5</code> e <code>target_probability = 0.60</code>, la funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code> restituisce <strong>3</strong>, non <strong>2</strong>. Questo perché <code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code> restituisce <strong>il più piccolo valore di <span class="math inline">\(y\)</span> tale che <span class="math inline">\(P(Y \leq y) \geq p\)</span></strong>. Verifichiamolo in R:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># = 0.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># = 0.8125</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Quindi:</p>
<ul>
<li>
<span class="math inline">\(P(Y \leq 2) = 0.5\)</span> → troppo poco</li>
<li>
<span class="math inline">\(P(Y \leq 3) = 0.8125\)</span> → supera il 60%</li>
</ul>
<p>Pertanto, <code>qbinom(0.6, 5, 0.5)</code> restituisce <code>3</code>.</p>
</section><section id="quantili-di-una-distribuzione-binomiale-1" class="level4" data-number="14.5.2.6"><h4 data-number="14.5.2.6" class="anchored" data-anchor-id="quantili-di-una-distribuzione-binomiale-1">
<span class="header-section-number">14.5.2.6</span> Quantili di una distribuzione binomiale</h4>
<p>La funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code> permette di calcolare il <strong>quantile</strong> di una distribuzione binomiale, cioè il <strong>numero minimo di successi</strong> <span class="math inline">\(y\)</span> tale che la probabilità cumulativa <span class="math inline">\(P(Y \leq y)\)</span> sia <strong>maggiore o uguale</strong> a una certa soglia.</p>
<p>Ad esempio, supponiamo di voler sapere <strong>qual è il numero minimo di successi</strong> tale che la probabilità cumulativa sia <strong>almeno 60%</strong>. Possiamo usare:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Probabilità cumulativa desiderata</span></span>
<span><span class="va">target_probability</span> <span class="op">&lt;-</span> <span class="fl">0.60</span></span>
<span></span>
<span><span class="co"># Calcolo del quantile</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">target_probability</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il risultato è <code>3</code>, il che significa che:</p>
<p><span class="math display">\[
P(Y \leq 3) = 0.8125 \geq 0.60,
\]</span></p>
<p>mentre</p>
<p><span class="math display">\[
P(Y \leq 2) = 0.5 &lt; 0.60.
\]</span></p>
<p>Quindi, servono <strong>almeno 3 successi</strong> per superare la soglia del 60% di probabilità cumulativa.</p>
<blockquote class="blockquote">
<p>🔎 <code>qbinom(p, size, prob)</code> restituisce il <strong>più piccolo valore di <span class="math inline">\(y\)</span></strong> tale che <span class="math inline">\(P(Y \leq y) \geq p\)</span>.</p>
</blockquote>
</section><section id="rappresentazione-grafica-del-quantile" class="level4" data-number="14.5.2.7"><h4 data-number="14.5.2.7" class="anchored" data-anchor-id="rappresentazione-grafica-del-quantile">
<span class="header-section-number">14.5.2.7</span> Rappresentazione grafica del quantile</h4>
<p>Per visualizzare il comportamento della funzione di ripartizione cumulativa e individuare il quantile per <span class="math inline">\(p = 0.60\)</span>, possiamo usare il seguente codice in R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametri</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">target_probability</span> <span class="op">&lt;-</span> <span class="fl">0.60</span></span>
<span></span>
<span><span class="co"># Asse y: numero di successi</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span></span>
<span></span>
<span><span class="co"># Calcolo dei valori cumulativi</span></span>
<span><span class="va">cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="va">y</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo del quantile</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="va">target_probability</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Successi <span class="op">=</span> <span class="va">y</span>, CDF <span class="op">=</span> <span class="va">cdf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grafico</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Successi</span>, y <span class="op">=</span> <span class="va">CDF</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_step</span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"hv"</span>, linewidth <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="va">target_probability</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">q</span> <span class="op">+</span> <span class="fl">0.4</span>, y <span class="op">=</span> <span class="fl">0.05</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"quantile ="</span>, <span class="va">q</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="va">target_probability</span> <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"soglia ="</span>, <span class="va">target_probability</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Numero di successi"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probabilità cumulativa"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.05</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>In questo grafico:</p>
<ul>
<li>la <strong>linea rossa tratteggiata</strong> rappresenta la soglia di probabilità desiderata (es. 0.60);</li>
<li>la <strong>linea blu tratteggiata verticale</strong> indica il quantile corrispondente, cioè il più piccolo valore di <span class="math inline">\(y\)</span> per cui <span class="math inline">\(P(Y \leq y) \geq 0.60\)</span>;</li>
<li>il valore calcolato è <code>3</code>, quindi con <strong>al massimo 3 successi</strong>, la probabilità cumulativa supera il 60%.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.4</strong></span> Consideriamo una <strong>distribuzione binomiale</strong> con <span class="math inline">\(n = 10\)</span> prove e probabilità di successo <span class="math inline">\(p = 0.2\)</span>. Supponiamo di voler calcolare la probabilità di ottenere <strong>al massimo 4 successi</strong>. In termini matematici, vogliamo calcolare:</p>
<p><span class="math display">\[
P(Y \leq 4) .
\]</span></p>
<p>In R, questo si ottiene con la funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo della probabilità cumulativa fino a 4 successi</span></span>
<span><span class="va">p_cumulativa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">4</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_cumulativa</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.967</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il risultato indica che c’è circa l’<strong>97%</strong> di probabilità di ottenere 4 o meno successi su 10 prove, quando la probabilità di successo in ciascuna prova è 0.2.</p>
<p>Ora facciamo il <strong>passaggio inverso</strong>: immaginiamo di conoscere la probabilità cumulativa (per esempio, 0.97) e vogliamo sapere <strong>quanti successi</strong> bisogna considerare per raggiungere quella probabilità.</p>
<p>Per questo usiamo la funzione <code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code>, che ci restituisce il <strong>più piccolo numero di successi <span class="math inline">\(y\)</span> tale che <span class="math inline">\(P(Y \leq y) \geq\)</span> quella probabilità</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo del numero di successi associato alla probabilità cumulativa</span></span>
<span><span class="va">numero_successi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="va">p_cumulativa</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">numero_successi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il valore ottenuto sarà <code>4</code>, cioè il <strong>minimo numero di successi</strong> per cui la probabilità cumulativa è almeno il 97%.</p>
<p><strong>Riepilogo concetti chiave</strong>:</p>
<ul>
<li>
<code>pbinom(y, n, p)</code> calcola la probabilità di ottenere <strong>al massimo <span class="math inline">\(y\)</span> successi</strong>;</li>
<li>
<code>qbinom(prob, n, p)</code> calcola <strong>il numero minimo di successi</strong> necessari per raggiungere almeno quella probabilità.</li>
</ul>
<p>In sintesi, <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> e <code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code> sono strumenti complementari: <code>pbinom</code> ci dà la probabilità di ottenere fino a un certo numero di successi, mentre <code>qbinom</code> ci dice fino a quanti successi possiamo ottenere per raggiungere una certa probabilità. Nell’analisi di una distribuzione binomiale (e di molte altre distribuzioni) queste funzioni aiutano a calcolare e interpretare facilmente probabilità cumulate e quantili in R, rendendo più semplice l’analisi di eventi aleatori.</p>
</div>
</section></section><section id="valore-atteso-e-deviazione-standard-nella-distribuzione-binomiale" class="level3" data-number="14.5.3"><h3 data-number="14.5.3" class="anchored" data-anchor-id="valore-atteso-e-deviazione-standard-nella-distribuzione-binomiale">
<span class="header-section-number">14.5.3</span> Valore atteso e deviazione standard nella distribuzione binomiale</h3>
<p>Nella distribuzione binomiale, possiamo calcolare facilmente due quantità molto importanti:</p>
<ul>
<li>
<strong>il valore atteso</strong> (o media), che ci dice <strong>quanti successi ci aspettiamo in media</strong> su un certo numero di prove;</li>
<li>
<strong>la deviazione standard</strong>, che ci dice <strong>quanto i risultati tendono a variare</strong> attorno alla media.</li>
</ul>
<p>Le formule sono le seguenti:</p>
<p><span id="eq-binom-distr-expval"><span class="math display">\[
\text{Media (valore atteso):} \quad \mu = n p ,
\tag{14.3}\]</span></span></p>
<p><span id="eq-binom-distr-var"><span class="math display">\[
\text{Deviazione standard:} \quad \sigma = \sqrt{n p (1 - p)} ,
\tag{14.4}\]</span></span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> è il numero di prove (per esempio, il numero di lanci di una moneta),</li>
<li>
<span class="math inline">\(p\)</span> è la probabilità di successo in ogni prova.</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Dimostrazione.</strong></p>
<p>La variabile <span class="math inline">\(Y\)</span> rappresenta il numero di successi in <span class="math inline">\(n\)</span> prove di Bernoulli indipendenti. Possiamo scriverla come somma di <span class="math inline">\(n\)</span> variabili casuali indipendenti:</p>
<p><span class="math display">\[
Y = Y_1 + Y_2 + \cdots + Y_n,
\]</span></p>
<p>dove ciascuna <span class="math inline">\(Y_i \sim \text{Bernoulli}(p)\)</span>, cioè:</p>
<p><span class="math display">\[
Y_i =
\begin{cases}
1 &amp; \text{con probabilità } p \\
0 &amp; \text{con probabilità } 1 - p
\end{cases}
\]</span></p>
<p><strong>Valore atteso di <span class="math inline">\(Y_i\)</span>.</strong></p>
<p>Per definizione del valore atteso:</p>
<p><span class="math display">\[
\mathbb{E}(Y_i) = 1 \cdot p + 0 \cdot (1 - p) = p.
\]</span></p>
<p><strong>Valore atteso di <span class="math inline">\(Y_i^2\)</span>.</strong></p>
<p>Poiché <span class="math inline">\(Y_i\)</span> assume solo i valori 0 e 1, si ha <span class="math inline">\(Y_i^2 = Y_i\)</span>. Quindi:</p>
<p><span class="math display">\[
\mathbb{E}(Y_i^2) = \mathbb{E}(Y_i) = p.
\]</span></p>
<p>La <strong>varianza</strong> di una variabile casuale si definisce come:</p>
<p><span class="math display">\[
\operatorname{Var}(Y_i) = \mathbb{E}(Y_i^2) - [\mathbb{E}(Y_i)]^2.
\]</span></p>
<p>Sostituendo i valori trovati sopra:</p>
<p><span class="math display">\[
\operatorname{Var}(Y_i) = p - p^2 = p(1 - p).
\]</span></p>
<p>Ricordiamo che <span class="math inline">\(Y = \sum_{i=1}^{n} Y_i\)</span> e che le <span class="math inline">\(Y_i\)</span> sono <strong>indipendenti</strong>. Una proprietà fondamentale della varianza è che se <span class="math inline">\(Z_1, \dots, Z_n\)</span> sono indipendenti:</p>
<p><span class="math display">\[
\operatorname{Var}(Z_1 + \cdots + Z_n) = \operatorname{Var}(Z_1) + \cdots + \operatorname{Var}(Z_n).
\]</span></p>
<p>Applichiamola al nostro caso:</p>
<p><span class="math display">\[
\operatorname{Var}(Y) = \sum_{i=1}^{n} \operatorname{Var}(Y_i).
\]</span></p>
<p>Poiché tutte le <span class="math inline">\(Y_i\)</span> hanno la stessa varianza <span class="math inline">\(p(1 - p)\)</span>, la somma diventa:</p>
<p><span class="math display">\[
\operatorname{Var}(Y) = n \cdot p(1 - p).
\]</span></p>
<p>Abbiamo dimostrato da definizione che, se <span class="math inline">\(Y \sim \text{Bin}(n, p)\)</span>, allora:</p>
<p><span class="math display">\[
\operatorname{Var}(Y) = n \cdot p \cdot (1 - p).
\]</span></p>
<p>Questa formula descrive la dispersione attesa nel numero di successi su <span class="math inline">\(n\)</span> prove indipendenti, ciascuna con probabilità di successo <span class="math inline">\(p\)</span>.</p>
</div>
</div>
</div>
<div id="exm-binom-var" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.5</strong></span> Supponiamo di lanciare <strong>4 volte una moneta truccata</strong> che ha una probabilità di successo (es. ottenere <em>testa</em>) pari a <span class="math inline">\(p = 0.2\)</span>.</p>
<p>Vogliamo calcolare:</p>
<ul>
<li>la media attesa del numero di teste,</li>
<li>la varianza,</li>
<li>e la deviazione standard.</li>
</ul>
<ol type="1">
<li>Calcolo del valore atteso (media):</li>
</ol>
<p><span class="math display">\[
\mu = n \cdot p = 4 \cdot 0.2 = 0.8 .
\]</span></p>
<p>Quindi, <strong>in media</strong>, ci aspettiamo di ottenere <strong>0.8 teste ogni 4 lanci</strong> (cioè meno di 1, ma ricordiamo che si tratta di una <strong>media</strong>).</p>
<ol start="2" type="1">
<li>Calcolo della varianza:</li>
</ol>
<p><span class="math display">\[
\text{Varianza} = n \cdot p \cdot (1 - p) = 4 \cdot 0.2 \cdot 0.8 = 0.64 .
\]</span></p>
<ol start="3" type="1">
<li>Calcolo della deviazione standard:</li>
</ol>
<p><span class="math display">\[
\sigma = \sqrt{0.64} \approx 0.8 .
\]</span></p>
<p>La deviazione standard ci dà un’idea della <strong>variabilità</strong> dei risultati: in questo caso, i valori osservati (numero di teste su 4 lanci) si discostano dalla media di circa 0.8 in media.</p>
</div>
</section><section id="verifica-con-una-simulazione-in-r" class="level3" data-number="14.5.4"><h3 data-number="14.5.4" class="anchored" data-anchor-id="verifica-con-una-simulazione-in-r">
<span class="header-section-number">14.5.4</span> Verifica con una simulazione in R</h3>
<p>Per vedere se i calcoli teorici dell’<a href="#exm-binom-var" class="quarto-xref">Esempio&nbsp;<span>14.5</span></a> funzionano anche nella pratica, possiamo <strong>simulare</strong> l’esperimento in R: lanciamo 4 monete, ma lo facciamo <strong>tantissime volte</strong> (ad esempio 1 milione) e calcoliamo la media e la varianza dei risultati ottenuti.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generiamo 1 milione di esperimenti: 4 lanci con probabilità di successo 0.2</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e6</span>, size <span class="op">=</span> <span class="fl">4</span>, prob <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcoliamo la media empirica</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8</span></span>
<span><span class="co"># [1] circa 0.8</span></span>
<span></span>
<span><span class="co"># Calcoliamo la varianza empirica</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.639</span></span>
<span><span class="co"># [1] circa 0.64</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Come possiamo vedere, i risultati ottenuti dalla simulazione sono <strong>molto vicini ai valori teorici</strong>: la media è circa <span class="math inline">\(\mu = 0.8\)</span> e la varianza circa <span class="math inline">\(0.64\)</span>, proprio come previsto dalle formule.</p>
<p>Questo non solo conferma che le <strong>formule per media e varianza nella distribuzione binomiale sono corrette</strong>, ma ci aiuta anche a capire meglio <strong>cosa significano</strong>:</p>
<ul>
<li>il <strong>valore atteso</strong> rappresenta la <strong>media dei risultati</strong> se ripetiamo l’esperimento moltissime volte;<br>
</li>
<li>la <strong>varianza</strong> (e la sua radice quadrata, la <strong>deviazione standard</strong>) misura <strong>quanto i risultati si allontanano dalla media</strong>.</li>
</ul>
<p>La simulazione mostra quindi in modo concreto che <strong>il valore atteso e la varianza descrivono il comportamento “medio” della variabile aleatoria</strong>, quando viene osservata in un numero molto grande di situazioni. In altre parole, questi concetti non sono solo teorici: ci dicono cosa aspettarci nella pratica, se ripetiamo molte volte lo stesso esperimento.</p>
</section></section><section id="funzioni-r-per-le-distribuzioni-di-probabilità" class="level2" data-number="14.6"><h2 data-number="14.6" class="anchored" data-anchor-id="funzioni-r-per-le-distribuzioni-di-probabilità">
<span class="header-section-number">14.6</span> Funzioni R per le distribuzioni di probabilità</h2>
<p>In R, le distribuzioni di probabilità (sia discrete che continue) sono gestite in modo sistematico. Per ogni distribuzione, esistono quattro funzioni principali, ognuna con un prefisso diverso che indica il tipo di operazione desiderata:</p>
<ul>
<li>
<strong><code>d*</code></strong>: calcola la <em>densità</em> (per distribuzioni continue) o la <em>probabilità</em> (per distribuzioni discrete);<br>
</li>
<li>
<strong><code>p*</code></strong>: calcola la <em>funzione di ripartizione cumulativa</em> (CDF), cioè <span class="math inline">\(P(Y \leq y)\)</span>;<br>
</li>
<li>
<strong><code>q*</code></strong>: calcola la <em>funzione quantile</em> (inversa della CDF);<br>
</li>
<li>
<strong><code>r*</code></strong>: genera <em>valori casuali</em> secondo la distribuzione specificata.</li>
</ul>
<p>Questa struttura è identica per tutte le distribuzioni implementate in R. La tabella seguente mostra un confronto tra le funzioni disponibili per due distribuzioni fondamentali: la <strong>binomiale</strong> (discreta) e la <strong>normale</strong> (continua).</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 35%">
<col style="width: 38%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Tipo di funzione</th>
<th style="text-align: left;">Binomiale (<span class="math inline">\(Y \sim \text{Bin}(n, p)\)</span>)</th>
<th style="text-align: left;">Normale (<span class="math inline">\(Y \sim \mathcal{N}(\mu, \sigma)\)</span>)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Densità o probabilità esatta</td>
<td style="text-align: left;"><code>dbinom(y, size = n, prob = p)</code></td>
<td style="text-align: left;"><code>dnorm(y, mean = mu, sd = sigma)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P(Y = y)\)</span></td>
<td style="text-align: left;"><code>dbinom(...)</code></td>
<td style="text-align: left;">❌ Non definita: per variabili continue si usa la densità</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Probabilità cumulativa</td>
<td style="text-align: left;"><code>pbinom(y, size = n, prob = p)</code></td>
<td style="text-align: left;"><code>pnorm(y, mean = mu, sd = sigma)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P(Y \geq y)\)</span></td>
<td style="text-align: left;"><code>1 - pbinom(y - 1, ...)</code></td>
<td style="text-align: left;"><code>1 - pnorm(y, ...)</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P(y_1 &lt; Y &lt; y_2)\)</span></td>
<td style="text-align: left;"><code>pbinom(y2, ...) - pbinom(y1, ...)</code></td>
<td style="text-align: left;"><code>pnorm(y2, ...) - pnorm(y1, ...)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Quantile (inversa della CDF)</td>
<td style="text-align: left;"><code>qbinom(q, size = n, prob = p)</code></td>
<td style="text-align: left;"><code>qnorm(q, mean = mu, sd = sigma)</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulazione di dati casuali</td>
<td style="text-align: left;"><code>rbinom(n, size = trials, prob = p)</code></td>
<td style="text-align: left;"><code>rnorm(n, mean = mu, sd = sigma)</code></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Nota">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Per le <strong>distribuzioni discrete</strong> (come la binomiale), <code>dbinom(y, ...)</code> restituisce la <strong>probabilità esatta</strong> di osservare il valore <span class="math inline">\(y\)</span>: ad esempio, <span class="math inline">\(P(Y = 2)\)</span>.</li>
<li>Per le <strong>distribuzioni continue</strong> (come la normale), <code>dnorm(y, ...)</code> restituisce la <strong>densità</strong> in <span class="math inline">\(y\)</span>, che non rappresenta direttamente una probabilità, ma è utile per visualizzare la forma della distribuzione.</li>
<li>Le probabilità cumulative (funzioni <code>p*</code>) e i quantili (funzioni <code>q*</code>) sono sempre definiti, sia per distribuzioni discrete che continue.</li>
<li>La generazione di dati casuali con <code>r*</code> è molto utile per simulazioni e verifiche empiriche.</li>
</ul>
<p>Più avanti, vedremo altre distribuzioni (Uniforme, Beta, Poisson, ecc.), tutte con lo stesso schema di funzioni: <code>d</code>, <code>p</code>, <code>q</code>, <code>r</code>.</p>
<p>Questa coerenza rende molto semplice imparare a usare le distribuzioni in R: una volta compreso lo schema, lo si può applicare a qualsiasi caso.</p>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.6</strong></span> &nbsp;</p>
<ol type="1">
<li>Calcolare la probabilità di esattamente <span class="math inline">\(y = 3\)</span> successi su <span class="math inline">\(n = 5\)</span> prove con <span class="math inline">\(p = 0.5\)</span>:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">3</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.312</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Calcolare la probabilità cumulativa <span class="math inline">\(P(Y \leq 3)\)</span>:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">3</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.812</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Calcolare il valore minimo <span class="math inline">\(y\)</span> tale che <span class="math inline">\(P(Y \leq y) \geq 0.9\)</span>:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="fl">0.9</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Generare un campione di 100 numeri casuali da una distribuzione binomiale:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] 2 2 4 1 3 2 3 2 2 2 3 3 3 3 1 4 1 1 0 2 2 2 4 1 2 3 3 1 5 2 3 3 0 3 2 3 4</span></span>
<span><span class="co">#&gt;  [38] 2 3 3 3 3 1 5 3 3 2 3 1 2 1 3 3 2 2 4 1 4 2 3 1 4 2 2 3 4 1 1 4 2 3 2 3 3</span></span>
<span><span class="co">#&gt;  [75] 3 1 4 4 3 3 4 3 3 3 2 2 3 3 2 4 4 3 2 2 0 3 1 3 1 2</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="distribuzione-di-poisson-1" class="level2" data-number="14.7"><h2 data-number="14.7" class="anchored" data-anchor-id="distribuzione-di-poisson-1">
<span class="header-section-number">14.7</span> Distribuzione di Poisson</h2>
<p>La <strong>distribuzione di Poisson</strong> è utilizzata per modellare il numero di eventi che si verificano in un determinato intervallo di tempo o spazio, con eventi indipendenti e un tasso costante di occorrenza.</p>
<p>La funzione di massa di probabilità (PMF) è data da:</p>
<p><span class="math display">\[
P(Y = y \mid \lambda) = \frac{\lambda^y \cdot e^{-\lambda}}{y!}, \quad y = 0, 1, 2, \ldots
\]</span></p>
<p>dove <span class="math inline">\(\lambda\)</span> rappresenta il tasso medio di eventi e <span class="math inline">\(y\)</span> è il numero di eventi.</p>
<p>La distribuzione di Poisson può essere derivata come il limite di una distribuzione binomiale quando il numero di prove, <span class="math inline">\(n\)</span>, tende all’infinito e la probabilità di successo in ciascuna prova, <span class="math inline">\(p\)</span>, tende a zero, in modo tale che <span class="math inline">\(np = \lambda\)</span>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dimostrazione
</div>
</div>
<div class="callout-body-container callout-body">
<p>Partiamo dalla funzione di probabilità binomiale:</p>
<p><span class="math display">\[
p(k) = \frac{n!}{k!(n - k)!} p^k (1 - p)^{n - k}.
\]</span></p>
<p>Impostiamo <span class="math inline">\(np = \lambda\)</span>, il che implica che <span class="math inline">\(p = \frac{\lambda}{n}\)</span>. Sostituendo <span class="math inline">\(p\)</span> con <span class="math inline">\(\frac{\lambda}{n}\)</span> nella formula binomiale, otteniamo:</p>
<p><span class="math display">\[
p(k) = \frac{n!}{k!(n - k)!} \left(\frac{\lambda}{n}\right)^k \left(1 - \frac{\lambda}{n}\right)^{n - k}.
\]</span></p>
<p>Ora, separiamo i termini per rendere più chiara la semplificazione. Possiamo riscrivere <span class="math inline">\(\left(\frac{\lambda}{n}\right)^k\)</span> come <span class="math inline">\(\frac{\lambda^k}{n^k}\)</span>, e <span class="math inline">\(\left(1 - \frac{\lambda}{n}\right)^{n - k}\)</span> come <span class="math inline">\(\left(1 - \frac{\lambda}{n}\right)^n \cdot \left(1 - \frac{\lambda}{n}\right)^{-k}\)</span>. Quindi, l’espressione diventa:</p>
<p><span class="math display">\[
p(k) = \frac{n!}{k!(n - k)!} \cdot \frac{\lambda^k}{n^k} \cdot \left(1 - \frac{\lambda}{n}\right)^n \cdot \left(1 - \frac{\lambda}{n}\right)^{-k}.
\]</span></p>
<p>Ora, separiamo ulteriormente i termini:</p>
<p><span class="math display">\[
p(k) = \frac{\lambda^k}{k!} \cdot \frac{n!}{(n - k)! n^k} \cdot \left(1 - \frac{\lambda}{n}\right)^n \cdot \left(1 - \frac{\lambda}{n}\right)^{-k}.
\]</span></p>
<p>Questo passaggio mostra come la funzione di probabilità binomiale, sotto le condizioni <span class="math inline">\(np = \lambda\)</span> e <span class="math inline">\(n \to \infty\)</span>, si trasformi gradualmente nella forma che conduce alla distribuzione di Poisson.</p>
<p>Quando <span class="math inline">\(n \to \infty\)</span>:</p>
<p><span class="math display">\[
\frac{\lambda}{n} \to 0
\]</span></p>
<p><span class="math display">\[
\frac{n!}{(n - k)! n^k} \to 1
\]</span></p>
<p><span class="math display">\[
\left(1 - \frac{\lambda}{n}\right)^n \to e^{-\lambda}
\]</span></p>
<p><span class="math display">\[
\left(1 - \frac{\lambda}{n}\right)^{-k} \to 1
\]</span></p>
<p>Si ottiene quindi:</p>
<p><span class="math display">\[
p(k) \to \frac{\lambda^k e^{-\lambda}}{k!}
\]</span></p>
<p>che è la funzione di Poisson.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dimostrazione
</div>
</div>
<div class="callout-body-container callout-body">
<p>Analizziamo il limite:</p>
<p><span class="math display">\[
\left(1 - \frac{\lambda}{n}\right)^n \to e^{-\lambda} \quad \text{quando} \quad n \to \infty.
\]</span></p>
<p>Un limite fondamentale in analisi matematica è:</p>
<p><span class="math display">\[
\lim_{n \to \infty} \left(1 + \frac{a}{n}\right)^n = e^a,
\]</span></p>
<p>dove <span class="math inline">\(e\)</span> è la base del logaritmo naturale (<span class="math inline">\(e \approx 2.71828\)</span>) e <span class="math inline">\(a\)</span> è una costante. Questo limite è alla base della definizione della funzione esponenziale.</p>
<p>Nel nostro caso, abbiamo l’espressione:</p>
<p><span class="math display">\[
\left(1 - \frac{\lambda}{n}\right)^n .
\]</span></p>
<p>Notiamo che questa è molto simile al limite notevole, ma con un segno negativo. Possiamo riscriverla come:</p>
<p><span class="math display">\[
\left(1 - \frac{\lambda}{n}\right)^n = \left(1 + \frac{-\lambda}{n}\right)^n.
\]</span></p>
<p>Applicando il limite notevole con <span class="math inline">\(a = -\lambda\)</span>, otteniamo:</p>
<p><span class="math display">\[
\lim_{n \to \infty} \left(1 + \frac{-\lambda}{n}\right)^n = e^{-\lambda}.
\]</span></p>
<p>Quindi, quando <span class="math inline">\(n\)</span> diventa molto grande, l’espressione <span class="math inline">\(\left(1 - \frac{\lambda}{n}\right)^n\)</span> si avvicina sempre di più a <span class="math inline">\(e^{-\lambda}\)</span>.</p>
</div>
</div>
<section id="proprietà-principali" class="level3" data-number="14.7.1"><h3 data-number="14.7.1" class="anchored" data-anchor-id="proprietà-principali">
<span class="header-section-number">14.7.1</span> Proprietà principali</h3>
<ul>
<li>
<strong>Media</strong>: <span class="math inline">\(\mathbb{E}[Y] = \lambda\)</span>
</li>
<li>
<strong>Varianza</strong>: <span class="math inline">\(\text{Var}(Y) = \lambda\)</span>
</li>
</ul>
<p>Di seguito, presentiamo esempi di calcolo e simulazione con R.</p>
</section><section id="grafico-della-distribuzione-di-poisson-con-lambda-2" class="level3" data-number="14.7.2"><h3 data-number="14.7.2" class="anchored" data-anchor-id="grafico-della-distribuzione-di-poisson-con-lambda-2">
<span class="header-section-number">14.7.2</span> Grafico della distribuzione di Poisson con <span class="math inline">\(\lambda = 2\)</span>
</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametro lambda</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Valori di y (numero di eventi)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># Calcolo delle probabilità</span></span>
<span><span class="va">probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">y</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creazione di un dataframe per ggplot</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Numero_eventi <span class="op">=</span> <span class="va">y</span>,</span>
<span>  Probabilita <span class="op">=</span> <span class="va">probabilities</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grafico della funzione di massa di probabilità </span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Numero_eventi</span>, y <span class="op">=</span> <span class="va">Probabilita</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Numero di eventi (k)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probabilità"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="calcolo-della-probabilità-per-un-numero-specifico-di-eventi" class="level3" data-number="14.7.3"><h3 data-number="14.7.3" class="anchored" data-anchor-id="calcolo-della-probabilità-per-un-numero-specifico-di-eventi">
<span class="header-section-number">14.7.3</span> Calcolo della probabilità per un numero specifico di eventi</h3>
<p>Per calcolare la probabilità di osservare esattamente 3 eventi con <span class="math inline">\(\lambda = 2\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">3</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.18</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="calcolo-della-probabilità-cumulativa-py-leq-3" class="level3" data-number="14.7.4"><h3 data-number="14.7.4" class="anchored" data-anchor-id="calcolo-della-probabilità-cumulativa-py-leq-3">
<span class="header-section-number">14.7.4</span> Calcolo della probabilità cumulativa <span class="math inline">\(P(Y \leq 3)\)</span>
</h3>
<p>Per calcolare <span class="math inline">\(P(Y \leq 3)\)</span>, la probabilità cumulativa:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cum_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="fl">3</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cum_prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.857</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="trovare-il-quantile-corrispondente-a-una-probabilità-data" class="level3" data-number="14.7.5"><h3 data-number="14.7.5" class="anchored" data-anchor-id="trovare-il-quantile-corrispondente-a-una-probabilità-data">
<span class="header-section-number">14.7.5</span> Trovare il quantile corrispondente a una probabilità data</h3>
<p>Per trovare il numero massimo di eventi per cui la probabilità cumulativa è al massimo <span class="math inline">\(0.8125\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quantile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">qpois</a></span><span class="op">(</span><span class="fl">0.8125</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">quantile</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="generazione-di-numeri-casuali" class="level3" data-number="14.7.6"><h3 data-number="14.7.6" class="anchored" data-anchor-id="generazione-di-numeri-casuali">
<span class="header-section-number">14.7.6</span> Generazione di numeri casuali</h3>
<p>Per generare un campione di 1.000.000 di osservazioni da una distribuzione di Poisson con <span class="math inline">\(\lambda = 2\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">1000000</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo di media e varianza del campione</span></span>
<span><span class="va">mean_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span><span class="va">var_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mean_sample</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">var_sample</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exm-poisson-v2-london" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.7</strong></span> Un esempio classico dell’uso della distribuzione di Poisson viene dalla <strong>Seconda Guerra Mondiale</strong>.</p>
<p><strong>Il contesto storico.</strong> Tra il 1944 e il 1945, Londra fu colpita da centinaia di <strong>missili V1 e V2</strong> lanciati dalla Germania nazista. Le autorità britanniche si chiesero se i bombardamenti seguissero una <strong>strategia mirata</strong>: i missili venivano forse lanciati intenzionalmente su certi quartieri? O si trattava invece di <strong>un comportamento casuale</strong>, come se fossero stati distribuiti a caso?</p>
<p>Per rispondere a questa domanda, il Ministero della Guerra britannico <strong>divise Londra in 576 aree di uguale superficie</strong> (ogni area misurava 0.25 km²) e <strong>registrò quanti missili avevano colpito ciascuna area</strong>. I dati furono poi analizzati dal matematico R. D. Clarke, che li pubblicò nel 1946.</p>
<p><strong>I dati osservati.</strong> Ecco una sintesi della distribuzione osservata:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Missili per area</th>
<th>Numero di aree</th>
<th>Frequenza relativa</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>229</td>
<td>0.398</td>
</tr>
<tr class="even">
<td>1</td>
<td>211</td>
<td>0.367</td>
</tr>
<tr class="odd">
<td>2</td>
<td>93</td>
<td>0.161</td>
</tr>
<tr class="even">
<td>3</td>
<td>35</td>
<td>0.061</td>
</tr>
<tr class="odd">
<td>4</td>
<td>7</td>
<td>0.012</td>
</tr>
<tr class="even">
<td>≥5</td>
<td>1</td>
<td>0.002</td>
</tr>
</tbody>
</table>
<p>Il <strong>numero medio di missili per area</strong> era <span class="math inline">\(\lambda \approx 0.93\)</span>. L’idea era confrontare queste frequenze con le probabilità teoriche previste da una distribuzione di Poisson con media <span class="math inline">\(\lambda = 0.93\)</span>.</p>
<p><strong>Interpretazione con la distribuzione di Poisson.</strong> Utilizzando la funzione <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code> in R, possiamo calcolare le probabilità teoriche per ciascun valore osservato, da 0 a 4 missili per area (valori superiori sono troppo rari per essere trattati separatamente).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametro medio osservato</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0.93</span></span>
<span></span>
<span><span class="co"># Valori possibili di missili per area</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span></span>
<span></span>
<span><span class="co"># Probabilità teoriche secondo la distribuzione di Poisson</span></span>
<span><span class="va">prob_teoriche</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">y</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggiungiamo la probabilità per y &gt;= 5</span></span>
<span><span class="va">prob_teoriche</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_teoriche</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prob_teoriche</span><span class="op">)</span><span class="op">)</span>  <span class="co"># y &gt;= 5</span></span>
<span></span>
<span><span class="co"># Visualizziamo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Missili_per_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"&gt;=5"</span><span class="op">)</span>,</span>
<span>  Probabilita_teorica <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_teoriche</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   Missili_per_area Probabilita_teorica</span></span>
<span><span class="co">#&gt; 1                0               0.395</span></span>
<span><span class="co">#&gt; 2                1               0.367</span></span>
<span><span class="co">#&gt; 3                2               0.171</span></span>
<span><span class="co">#&gt; 4                3               0.053</span></span>
<span><span class="co">#&gt; 5                4               0.012</span></span>
<span><span class="co">#&gt; 6              &gt;=5               0.003</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confrontando le probabilità teoriche della Poisson con quelle osservate nei dati reali, <strong>i risultati erano sorprendentemente simili</strong>. Questo suggeriva che <strong>i missili non erano lanciati su bersagli specifici</strong>, ma seguivano un comportamento <strong>statisticamente compatibile con una distribuzione casuale</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Frequenze osservate (dati originali di Clarke, 1946)</span></span>
<span><span class="va">frequenze_osservate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">229</span>, <span class="fl">211</span>, <span class="fl">93</span>, <span class="fl">35</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">valori_missili</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="st">"≥5"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo frequenze teoriche con Poisson (lambda = 0.93)</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0.93</span></span>
<span><span class="va">prob_teoriche</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="va">prob_teoriche</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_teoriche</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prob_teoriche</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Per y &gt;= 5</span></span>
<span></span>
<span><span class="co"># Numero totale di aree (come somma delle osservazioni)</span></span>
<span><span class="va">n_aree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">frequenze_osservate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Frequenze attese = probabilità teoriche * numero totale di aree</span></span>
<span><span class="va">frequenze_attese</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_teoriche</span> <span class="op">*</span> <span class="va">n_aree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Costruzione del data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Missili_per_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">valori_missili</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"≥5"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Osservate <span class="op">=</span> <span class="va">frequenze_osservate</span>,</span>
<span>  Attese <span class="op">=</span> <span class="va">frequenze_attese</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conversione in formato lungo per ggplot2</span></span>
<span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">df</span>, id.vars <span class="op">=</span> <span class="st">"Missili_per_area"</span>, variable.name <span class="op">=</span> <span class="st">"Tipo"</span>, value.name <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creazione del grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_long</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Missili_per_area</span>, y <span class="op">=</span> <span class="va">Frequenza</span>, fill <span class="op">=</span> <span class="va">Tipo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Numero di missili per area"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Numero di aree"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Frequenza"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Le <strong>barre blu</strong> rappresentano le <strong>frequenze osservate</strong> (quante aree hanno ricevuto 0, 1, 2… missili).</li>
<li>Le <strong>barre rosse</strong> mostrano le <strong>frequenze attese</strong> se i missili fossero stati lanciati in modo <strong>completamente casuale</strong>, seguendo una distribuzione di <strong>Poisson con <span class="math inline">\(\lambda = 0.93\)</span></strong>.</li>
</ul>
<p>La sovrapposizione tra i due andamenti è molto buona, il che rafforza l’idea che i bombardamenti fossero distribuiti casualmente — <strong>senza un pattern strategico</strong> apparente.</p>
<p><strong>Cosa ci insegna questo esempio?</strong></p>
<ul>
<li>La distribuzione di Poisson è adatta quando vogliamo <strong>modellare eventi rari e indipendenti</strong> nello spazio o nel tempo.</li>
<li>I dati dei missili su Londra mostrano come un fenomeno che a prima vista potrebbe sembrare non casuale (per via della concentrazione locale degli eventi) possa invece essere <strong>ben descritto da un modello probabilistico semplice</strong>, se considerato su una scala adatta.</li>
</ul>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.8</strong></span> Supponiamo di avere osservato, nel corso degli anni, che la <strong>frequenza relativa di bocciature</strong> all’esame di <strong>Psicometria</strong> è di circa <strong>10%</strong> (cioè <span class="math inline">\(p = 0.1\)</span>). Tuttavia, il <strong>numero di studenti iscritti a ciascun appello varia in modo estremo</strong>: al primo appello dell’anno partecipano più di 200 studenti, mentre negli ultimi appelli solo 2 o 3.</p>
<p>Questo rende <strong>inadeguato l’uso della distribuzione binomiale</strong>, che richiede un numero di prove (<span class="math inline">\(n\)</span>) fisso o noto per ciascun appello.</p>
<p>In questi casi, possiamo <strong>modellare il numero di bocciature per appello</strong> usando una distribuzione di Poisson.</p>
<p>Per ogni appello, possiamo stimare <span class="math inline">\(\lambda\)</span> moltiplicando il <strong>numero di studenti iscritti</strong> (<span class="math inline">\(n\)</span>) per la <strong>frequenza attesa di bocciature</strong> (<span class="math inline">\(p = 0.1\)</span>). A quel punto, il numero di bocciature osservate può essere approssimato da:</p>
<p><span class="math display">\[
Y \sim \text{Poisson}(\lambda = n \cdot p) .
\]</span></p>
<p>Quindi la distribuzione cambia da appello ad appello, perché <strong><span class="math inline">\(\lambda\)</span> cambia con <span class="math inline">\(n\)</span></strong>, ma il <strong>modello rimane Poissoniano</strong>.</p>
<p>Supponiamo di avere osservato i seguenti dati.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">Appello</th>
<th style="text-align: right;">Numero iscritti (<span class="math inline">\(n\)</span>)</th>
<th style="text-align: right;"><span class="math inline">\(\lambda = n \cdot p\)</span></th>
<th>Distribuzione di bocciature</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;"><span class="math inline">\(220 \cdot 0.1 = 22\)</span></td>
<td><span class="math inline">\(Y \sim \text{Poisson}(22)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;"><span class="math inline">\(95 \cdot 0.1 = 9.5\)</span></td>
<td><span class="math inline">\(Y \sim \text{Poisson}(9.5)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"><span class="math inline">\(3 \cdot 0.1 = 0.3\)</span></td>
<td><span class="math inline">\(Y \sim \text{Poisson}(0.3)\)</span></td>
</tr>
</tbody>
</table>
<p>Per ogni appello, possiamo usare la funzione <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code> in R per calcolare la probabilità di osservare un certo numero di bocciature, dato il valore di <span class="math inline">\(\lambda\)</span> specifico per quell’appello.</p>
<p>Ad esempio, possiamo chiederci quale sia la probabilità che, nel secondo appello (95 iscritti), si registrino esattamente 8 bocciature.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">95</span> <span class="op">*</span> <span class="fl">0.1</span>  <span class="co"># = 9.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">8</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.123</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questa funzione calcola <span class="math inline">\(P(Y = 8)\)</span> per una variabile <span class="math inline">\(Y \sim \text{Poisson}(9.5)\)</span>, cioè la probabilità di osservare esattamente 8 bocciature su 95 iscritti.</p>
<p>Supponiamo di voler simulare il numero di bocciature in <strong>8 appelli</strong> con numeri di iscritti variabili. Possiamo fare così:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Numero iscritti per ciascun appello</span></span>
<span><span class="va">n_iscritti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">95</span>, <span class="fl">60</span>, <span class="fl">45</span>, <span class="fl">20</span>, <span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Probabilità storica di bocciatura</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="co"># Parametri lambda per ogni appello</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">n_iscritti</span> <span class="op">*</span> <span class="va">p</span></span>
<span></span>
<span><span class="co"># Simulazione delle bocciature per ciascun appello</span></span>
<span><span class="va">bocciature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Appello <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, </span>
<span>  Iscritti <span class="op">=</span> <span class="va">n_iscritti</span>, </span>
<span>  Lambda <span class="op">=</span> <span class="va">lambda</span>, </span>
<span>  Bocciature <span class="op">=</span> <span class="va">bocciature</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   Appello Iscritti Lambda Bocciature</span></span>
<span><span class="co">#&gt; 1       1      220   22.0         28</span></span>
<span><span class="co">#&gt; 2       2       95    9.5          8</span></span>
<span><span class="co">#&gt; 3       3       60    6.0          8</span></span>
<span><span class="co">#&gt; 4       4       45    4.5          5</span></span>
<span><span class="co">#&gt; 5       5       20    2.0          2</span></span>
<span><span class="co">#&gt; 6       6       12    1.2          2</span></span>
<span><span class="co">#&gt; 7       7        6    0.6          0</span></span>
<span><span class="co">#&gt; 8       8        3    0.3          0</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>📈 <strong>Visualizzazione.</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Appello <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, Bocciature <span class="op">=</span> <span class="va">bocciature</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Appello</span>, y <span class="op">=</span> <span class="va">Bocciature</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Appello"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Numero di bocciature"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>In sintesi,</p>
<ul>
<li>quando il numero di studenti iscritti a un appello <strong>non è noto a priori</strong> o <strong>varia fortemente</strong>, non è adeguato usare la distribuzione binomiale;</li>
<li>se conosciamo la <strong>frequenza relativa di bocciature</strong> (es. <span class="math inline">\(p = 0.1\)</span>), possiamo usare la distribuzione di <strong>Poisson con <span class="math inline">\(\lambda = n \cdot p\)</span></strong>, adattandola a ciascun appello;</li>
<li>questo approccio è particolarmente utile per fare <strong>stima e simulazione</strong> del numero di bocciature attese, senza dover modellare tutti i singoli esiti.</li>
</ul>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.9</strong></span> Uno degli esempi più comuni per introdurre la distribuzione di Poisson riguarda il numero di <strong>nascite giornaliere</strong> in un ospedale.</p>
<p>Supponiamo che, in un grande ospedale, la <strong>media storica</strong> sia di <strong>4.5 nascite al giorno</strong>. Possiamo allora descrivere il numero di nascite in un giorno con una <strong>variabile casuale Poisson</strong> con parametro <span class="math inline">\(\lambda = 4.5\)</span>:</p>
<p><span class="math display">\[
Y \sim \text{Poisson}(\lambda = 4.5) .
\]</span></p>
<p>Ci chiediamo, ad esempio: qual è la probabilità che in un giorno nascano <strong>esattamente 6 bambini</strong>?</p>
<p>Possiamo calcolarla con la funzione <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametro medio: 4.5 nascite al giorno</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">4.5</span></span>
<span></span>
<span><span class="co"># Probabilità di osservare esattamente 6 nascite</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">6</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.128</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo valore rappresenta la probabilità che, in un giorno qualsiasi, si verifichino <strong>esattamente 6 nascite</strong>.</p>
<p><strong>Simulazione.</strong> Simuliamo ora il numero di nascite in <strong>365 giorni consecutivi</strong>, supponendo che la media rimanga costante a 4.5:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># Per rendere i risultati riproducibili</span></span>
<span></span>
<span><span class="va">n_days</span> <span class="op">&lt;-</span> <span class="fl">365</span></span>
<span><span class="va">simulated_births</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">n_days</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Proporzione di giorni con esattamente 6 nascite</span></span>
<span><span class="va">proportion_six_births</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulated_births</span> <span class="op">==</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">proportion_six_births</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.14</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo ci dice, tra i 365 giorni simulati, <strong>quanta parte dell’anno ha avuto esattamente 6 nascite</strong>. Il valore ottenuto può essere confrontato con la probabilità teorica calcolata prima.</p>
<p><strong>Visualizzazione.</strong> Possiamo rappresentiamo graficamente i dati simulati con un istogramma:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Costruzione del data frame</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Nascite <span class="op">=</span> <span class="va">simulated_births</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Istogramma</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Nascite</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">simulated_births</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Numero di nascite per giorno"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequenza (numero di giorni)"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>L’istogramma mostra quante volte si sono verificati 0, 1, 2, …, 10 o più nascite in un giorno, evidenziando la <strong>variabilità naturale</strong> attorno alla media.</p>
<p>Calcoliamo ora quanto è probabile che si verifichino <strong>più di 6 nascite in un giorno</strong>.</p>
<p>Probabilità teorica:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_more_than_six</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="fl">6</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prob_more_than_six</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.169</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Proporzione osservata nella simulazione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">proportion_more_than_six</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">simulated_births</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">proportion_more_than_six</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.17</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il confronto tra probabilità teorica e proporzione simulata mostra come la distribuzione di Poisson <strong>riproduca bene i fenomeni reali</strong>, quando gli eventi sono <strong>indipendenti</strong>, <strong>discreti</strong> e <strong>relativamente frequenti ma non troppo</strong>.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Esempio 14.10</strong></span> Questo esempio è tratto dal celebre lavoro di <strong>Ladislaus von Bortkiewicz</strong> del 1898, spesso citato come una delle prime applicazioni reali della <strong>distribuzione di Poisson</strong>.</p>
<p>Von Bortkiewicz studiò un evento piuttosto inusuale: le <strong>morti causate da calci di cavallo</strong> all’interno della <strong>cavalleria dell’esercito prussiano</strong>. L’obiettivo era capire se questi eventi, seppur rari, potessero essere considerati <strong>casuali e indipendenti</strong>, oppure se fossero distribuiti in modo irregolare e non prevedibile.</p>
<p>Per farlo, raccolse i dati su <strong>10 squadroni</strong> osservati per <strong>20 anni consecutivi</strong>, ottenendo così <strong>200 unità di osservazione</strong>, che possiamo chiamare <strong>“squadroni-anno”</strong>.</p>
<p><strong>I dati raccolti.</strong> Per ogni squadrone-anno, fu registrato il <strong>numero di morti per calci di cavallo</strong>. I dati furono poi raggruppati per numero di decessi:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 20%">
<col style="width: 31%">
</colgroup>
<thead><tr class="header">
<th>Numero di decessi annui</th>
<th>Frequenza osservata</th>
<th>Frequenza relativa</th>
<th>Probabilità teorica (Poisson)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>109</td>
<td>0.545</td>
<td>0.543</td>
</tr>
<tr class="even">
<td>1</td>
<td>65</td>
<td>0.325</td>
<td>0.331</td>
</tr>
<tr class="odd">
<td>2</td>
<td>22</td>
<td>0.110</td>
<td>0.101</td>
</tr>
<tr class="even">
<td>3</td>
<td>3</td>
<td>0.015</td>
<td>0.021</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1</td>
<td>0.005</td>
<td>0.003</td>
</tr>
</tbody>
</table>
<ul>
<li>
<strong>Frequenza osservata</strong>: Quante volte ciascun numero di decessi è stato osservato tra i 200 squadroni-anno.</li>
<li>
<strong>Frequenza relativa</strong>: Frequenza osservata divisa per 200.</li>
<li>
<strong>Probabilità teorica</strong>: Calcolata con la <strong>distribuzione di Poisson con parametro <span class="math inline">\(\lambda = 0.61\)</span></strong>, pari alla media osservata dei decessi annui.</li>
</ul>
<p>La distribuzione di Poisson è perfetta per questo tipo di situazione perché:</p>
<ul>
<li>stiamo contando il numero di <strong>eventi rari</strong> (decessi accidentali),</li>
<li>che si verificano in <strong>unità di tempo o spazio fisse</strong> (lo “squadrone-anno”),</li>
<li>e presumiamo che questi eventi siano <strong>indipendenti tra loro</strong>.</li>
</ul>
<p>In questo caso, <span class="math inline">\(\lambda = 0.61\)</span> rappresenta il <strong>numero medio di decessi per squadrone in un anno</strong>. La variabilità intorno a questo valore può essere descritta dalla distribuzione di Poisson, che assegna a ciascun possibile numero di decessi (0, 1, 2, …) una <strong>probabilità teorica</strong>.</p>
<p><strong>Confronto tra dati osservati e modello di Poisson.</strong> Come si può notare dalla tabella, <strong>le frequenze osservate sono sorprendentemente simili</strong> alle probabilità teoriche ottenute dal modello di Poisson. Ad esempio:</p>
<ul>
<li>la proporzione di squadroni-anno con <strong>zero decessi</strong> è 0.545, contro una probabilità teorica di 0.543;</li>
<li>per <strong>un decesso</strong>, la frequenza relativa è 0.325, vicina alla probabilità teorica di 0.331;</li>
<li>anche le classi meno frequenti (2, 3 e 4 decessi) sono coerenti con i valori attesi.</li>
</ul>
<p>Questo esempio dimostra che la distribuzione di Poisson <strong>non solo è utile per modellare eventi rari</strong>, ma fornisce anche una buona descrizione <strong>quantitativa</strong> del comportamento osservato nel mondo reale.</p>
<p>In sintesi,</p>
<ul>
<li>il lavoro di von Bortkiewicz è uno dei primi esempi storici di <strong>modellizzazione di dati reali con la teoria delle probabilità</strong>;</li>
<li>la distribuzione di Poisson si è rivelata efficace nel <strong>descrivere un fenomeno raro, ma regolare</strong>, suggerendo che i decessi fossero eventi <strong>casuali e indipendenti</strong>, non dovuti a fattori sistematici;</li>
<li>ancora oggi, questo esempio viene usato per insegnare che anche gli eventi accidentali e poco frequenti possono essere <strong>prevedibili in media</strong> e descritti in modo elegante da un modello probabilistico.</li>
</ul>
<p>Qui di seguito viene fornito il <strong>codice R</strong> che riproduce l’analisi di von Bortkiewicz, calcola le <strong>probabilità teoriche</strong> secondo la distribuzione di Poisson con parametro <span class="math inline">\(\lambda = 0.61\)</span> e confronta visivamente le <strong>frequenze osservate</strong> con le <strong>frequenze attese</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Dati osservati da von Bortkiewicz</span></span>
<span><span class="va">decessi</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="va">frequenze_osservate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">109</span>, <span class="fl">65</span>, <span class="fl">22</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">frequenze_osservate</span><span class="op">)</span>  <span class="co"># Totale = 200 squadroni-anno</span></span>
<span></span>
<span><span class="co"># Frequenze relative</span></span>
<span><span class="va">frequenze_relative</span> <span class="op">&lt;-</span> <span class="va">frequenze_osservate</span> <span class="op">/</span> <span class="va">n_total</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcolo delle probabilità teoriche con la distribuzione di Poisson:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametro medio osservato</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0.61</span></span>
<span></span>
<span><span class="co"># Calcolo delle probabilità teoriche di Poisson</span></span>
<span><span class="va">prob_poisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">decessi</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confronto: osservato vs teorico.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Frequenze attese = probabilità teoriche * numero totale di casi</span></span>
<span><span class="va">frequenze_attese</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_poisson</span> <span class="op">*</span> <span class="va">n_total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creazione del data frame per il confronto</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Decessi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">decessi</span><span class="op">)</span>,</span>
<span>  Osservato <span class="op">=</span> <span class="va">frequenze_osservate</span>,</span>
<span>  Atteso <span class="op">=</span> <span class="va">frequenze_attese</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt;   Decessi Osservato Atteso</span></span>
<span><span class="co">#&gt; 1       0       109    109</span></span>
<span><span class="co">#&gt; 2       1        65     66</span></span>
<span><span class="co">#&gt; 3       2        22     20</span></span>
<span><span class="co">#&gt; 4       3         3      4</span></span>
<span><span class="co">#&gt; 5       4         1      1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizzazione: confronto tra frequenze osservate e attese.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Conversione da wide a long format con pivot_longer()</span></span>
<span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Osservato</span>, <span class="va">Atteso</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"Tipo"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"Frequenza"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Mostra le prime righe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   Decessi Tipo      Frequenza</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;   &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 0       Osservato       109</span></span>
<span><span class="co">#&gt; 2 0       Atteso          109</span></span>
<span><span class="co">#&gt; 3 1       Osservato        65</span></span>
<span><span class="co">#&gt; 4 1       Atteso           66</span></span>
<span><span class="co">#&gt; 5 2       Osservato        22</span></span>
<span><span class="co">#&gt; 6 2       Atteso           20</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Grafico a barre affiancate</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_long</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Decessi</span>, y <span class="op">=</span> <span class="va">Frequenza</span>, fill <span class="op">=</span> <span class="va">Tipo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Numero di decessi per squadrone-anno"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequenza"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Tipo"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="13_discr_rv_distr_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Le <strong>barre blu</strong> mostrano i dati <strong>osservati</strong> da von Bortkiewicz.</li>
<li>Le <strong>barre rosse</strong> indicano le <strong>frequenze attese</strong> se il numero di decessi segue una distribuzione di Poisson con media <span class="math inline">\(\lambda = 0.61\)</span>.</li>
<li>La <strong>buona corrispondenza visiva</strong> tra le due serie supporta l’idea che i decessi siano <strong>eventi rari, indipendenti e distribuiti casualmente</strong>.</li>
</ul>
</div>
</section></section><section id="distribuzione-beta-binomiale" class="level2" data-number="14.8"><h2 data-number="14.8" class="anchored" data-anchor-id="distribuzione-beta-binomiale">
<span class="header-section-number">14.8</span> Distribuzione Beta-Binomiale</h2>
<p>La distribuzione beta-binomiale rappresenta una estensione della distribuzione binomiale che tiene conto della variabilità nella probabilità di successo tra i vari tentativi. Viene descritta da tre parametri principali: <span class="math inline">\(N\)</span>, <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>.</p>
<p>Nel dettaglio, la funzione di massa di probabilità per la distribuzione beta-binomiale è data da:</p>
<p><span id="eq-beta-binom-formula"><span class="math display">\[
\text{BetaBinomiale}(y | N, \alpha, \beta) = \binom{N}{y} \cdot \frac{B(y + \alpha, N - y + \beta)}{B(\alpha, \beta)},
\tag{14.5}\]</span></span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(y\)</span> indica il numero di successi osservati.</li>
<li>
<span class="math inline">\(N\)</span> rappresenta il numero totale di tentativi.</li>
<li>
<span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> sono i parametri della distribuzione beta, che modellano la variabilità nella probabilità di successo tra i tentativi.</li>
</ul>
<p>La funzione <span class="math inline">\(B(u, v)\)</span>, nota come funzione beta, è definita tramite l’uso della funzione gamma <span class="math inline">\(\Gamma\)</span>, secondo la formula:</p>
<p><span class="math display">\[
B(u, v) = \frac{\Gamma(u) \Gamma(v)}{\Gamma(u + v)},
\]</span></p>
<p>dove la funzione gamma <span class="math inline">\(\Gamma\)</span> generalizza il concetto di fattoriale a numeri reali e complessi.</p>
<p>L’importanza della distribuzione beta-binomiale deriva dalla sua capacità di modellare situazioni in cui la probabilità di successo non è fissa, ma segue una distribuzione di probabilità, specificatamente una distribuzione beta. Ciò la rende particolarmente adatta per applicazioni in cui le probabilità di successo cambiano in maniera incerta da un tentativo all’altro, come può avvenire in contesti di ricerca clinica o in studi comportamentali. Rispetto alla distribuzione binomiale, che assume una probabilità di successo costante per tutti i tentativi, la beta-binomiale offre una rappresentazione più realistica e flessibile per dati empirici che presentano variabilità nelle probabilità di successo.</p>
</section><section id="riflessioni-conclusive" class="level2" data-number="14.9"><h2 data-number="14.9" class="anchored" data-anchor-id="riflessioni-conclusive">
<span class="header-section-number">14.9</span> Riflessioni Conclusive</h2>
<p>In questo capitolo, abbiamo approfondito alcune delle distribuzioni discrete più importanti, ognuna con caratteristiche uniche e campi di applicazione specifici. Abbiamo iniziato con la <strong>distribuzione di Bernoulli</strong>, che modella esperimenti con due soli esiti possibili, per poi passare alla <strong>distribuzione Binomiale</strong>, che generalizza la Bernoulli considerando un numero fisso di prove indipendenti. Successivamente, abbiamo esaminato la <strong>distribuzione di Poisson</strong>, utile per descrivere eventi rari in un intervallo di tempo o spazio, e la <strong>distribuzione Beta-Binomiale</strong>, un’estensione della Binomiale che incorpora la variabilità nella probabilità di successo, rendendola particolarmente adatta per modellare situazioni in cui tale probabilità non è fissa. Infine, abbiamo discusso la <strong>distribuzione Discreta Uniforme</strong>, che assegna la stessa probabilità a ciascun evento in un insieme finito e discreto.</p>
<p>Queste distribuzioni rappresentano il fondamento dell’analisi statistica discreta e trovano applicazione in numerosi ambiti. In particolare, nel contesto dell’<strong>inferenza bayesiana</strong>, la comprensione della distribuzione Binomiale e della sua estensione Beta-Binomiale è essenziale. Queste distribuzioni, infatti, forniscono gli strumenti necessari per l’<strong>aggiornamento bayesiano</strong>, un processo chiave che permette di rivedere le nostre credenze iniziali alla luce di nuovi dati. Questo concetto sarà ulteriormente esplorato nei capitoli successivi, dove approfondiremo come le distribuzioni a priori e a posteriori interagiscono nel quadro bayesiano.</p>
</section><section id="esercitazione-in-classe" class="level2" data-number="14.10"><h2 data-number="14.10" class="anchored" data-anchor-id="esercitazione-in-classe">
<span class="header-section-number">14.10</span> Esercitazione in Classe</h2>
<p>Valutate le emozioni che verranno presentate sullo schermo usando questo <a href="https://docs.google.com/forms/d/e/1FAIpQLScWZD9XQoWJvf58fvQ6KGPJ562JxiKeg_azCIWagi1_BVtdpg/viewform?usp=header">link</a>.</p>
<p>Scala di risposta:</p>
<ul>
<li>Rabbia: 1</li>
<li>Disgusto: 2</li>
<li>Paura: 3</li>
<li>Felicità: 4</li>
<li>Tristezza: 5</li>
</ul></section><section id="esercizi" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="esercizi">Esercizi</h2>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi 1">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Per ciascuna delle distribuzioni di massa di probabilità discusse, utilizzare R per:</p>
<ul>
<li>creare un grafico della funzione, scegliendo opportunamente i parametri;</li>
<li>estrarre un campione di 1000 valori casuali dalla distribuzione e visualizzarlo con un istogramma;</li>
<li>calcolare la media e la deviazione standard dei campioni e confrontarle con i valori teorici attesi;</li>
<li>stimare l’intervallo centrale del 94% utilizzando i campioni simulati;</li>
<li>determinare i quantili della distribuzione per gli ordini 0.05, 0.25, 0.75 e 0.95;</li>
<li>scegliendo un valore della distribuzione pari alla media più una deviazione standard, calcolare la probabilità che la variabile aleatoria assuma un valore minore o uguale a questo valore.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi 2">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Esercizi sulla distribuzione binomiale, risolvibili usando R, sono disponibili sulla seguente <a href="https://mathcenter.oxford.emory.edu/site/math117/probSetBinomialProbabilities/">pagina web</a>.</p>
</div>
</div>
</div>
</section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] reshape2_1.4.4        pillar_1.11.0         tinytable_0.13.0     </span></span>
<span><span class="co">#&gt;  [4] patchwork_1.3.2       ggdist_3.3.3          tidybayes_3.0.7      </span></span>
<span><span class="co">#&gt;  [7] bayesplot_1.14.0      ggplot2_3.5.2         reliabilitydiag_0.2.1</span></span>
<span><span class="co">#&gt; [10] priorsense_1.1.1      posterior_1.6.1       loo_2.8.0            </span></span>
<span><span class="co">#&gt; [13] rstan_2.32.7          StanHeaders_2.32.10   brms_2.22.0          </span></span>
<span><span class="co">#&gt; [16] Rcpp_1.1.0            sessioninfo_1.2.3     conflicted_1.2.0     </span></span>
<span><span class="co">#&gt; [19] janitor_2.2.1         matrixStats_1.5.0     modelr_0.1.11        </span></span>
<span><span class="co">#&gt; [22] tibble_3.3.0          dplyr_1.1.4           tidyr_1.3.1          </span></span>
<span><span class="co">#&gt; [25] rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      compiler_4.5.1        systemfonts_1.2.3    </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5           stringr_1.5.1         pkgconfig_2.0.3      </span></span>
<span><span class="co">#&gt; [13] arrayhelpers_1.1-0    fastmap_1.2.0         backports_1.5.0      </span></span>
<span><span class="co">#&gt; [16] labeling_0.4.3        utf8_1.2.6            rmarkdown_2.29       </span></span>
<span><span class="co">#&gt; [19] ragg_1.5.0            purrr_1.1.0           xfun_0.53            </span></span>
<span><span class="co">#&gt; [22] cachem_1.1.0          jsonlite_2.0.0        broom_1.0.9          </span></span>
<span><span class="co">#&gt; [25] parallel_4.5.1        R6_2.6.1              stringi_1.8.7        </span></span>
<span><span class="co">#&gt; [28] RColorBrewer_1.1-3    lubridate_1.9.4       estimability_1.5.1   </span></span>
<span><span class="co">#&gt; [31] knitr_1.50            zoo_1.8-14            pacman_0.5.1         </span></span>
<span><span class="co">#&gt; [34] Matrix_1.7-4          splines_4.5.1         timechange_0.3.0     </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.1      abind_1.4-8           yaml_2.3.10          </span></span>
<span><span class="co">#&gt; [40] codetools_0.2-20      curl_7.0.0            pkgbuild_1.4.8       </span></span>
<span><span class="co">#&gt; [43] lattice_0.22-7        plyr_1.8.9            withr_3.0.2          </span></span>
<span><span class="co">#&gt; [46] bridgesampling_1.1-2  coda_0.19-4.1         evaluate_1.0.5       </span></span>
<span><span class="co">#&gt; [49] survival_3.8-3        RcppParallel_5.1.11-1 tensorA_0.36.2.1     </span></span>
<span><span class="co">#&gt; [52] checkmate_2.3.3       stats4_4.5.1          distributional_0.5.0 </span></span>
<span><span class="co">#&gt; [55] generics_0.1.4        rprojroot_2.1.1       rstantools_2.5.0     </span></span>
<span><span class="co">#&gt; [58] scales_1.4.0          xtable_1.8-4          glue_1.8.0           </span></span>
<span><span class="co">#&gt; [61] emmeans_1.11.2-8      tools_4.5.1           mvtnorm_1.3-3        </span></span>
<span><span class="co">#&gt; [64] grid_4.5.1            QuickJSR_1.8.0        colorspace_2.1-1     </span></span>
<span><span class="co">#&gt; [67] nlme_3.1-168          cli_3.6.5             textshaping_1.0.3    </span></span>
<span><span class="co">#&gt; [70] svUnit_1.0.8          Brobdingnag_1.2-9     V8_7.0.0             </span></span>
<span><span class="co">#&gt; [73] gtable_0.3.6          digest_0.6.37         TH.data_1.1-4        </span></span>
<span><span class="co">#&gt; [76] htmlwidgets_1.6.4     farver_2.1.2          memoise_2.0.1        </span></span>
<span><span class="co">#&gt; [79] htmltools_0.5.8.1     lifecycle_1.0.4       MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-blitzstein2019introduction" class="csl-entry" role="listitem">
Blitzstein, J. K., &amp; Hwang, J. (2019). <em>Introduction to probability</em>. CRC Press.
</div>
<div id="ref-schervish2014probability" class="csl-entry" role="listitem">
Schervish, M. J., &amp; DeGroot, M. H. (2014). <em>Probability and statistics</em> (Vol. 563). Pearson Education London, UK:
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/utet-prob\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/probability/12_intro_distributions.html" class="pagination-link" aria-label="Introduzione alle distribuzioni di probabilità">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/probability/14_cont_rv_distr.html" class="pagination-link" aria-label="Distribuzioni di v.c. continue">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Probabilità per la psicologia</strong> — Modulo di richiamo del progetto UTET a supporto del manuale <em>Metodi bayesiani in psicologia</em>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/utet-prob/blob/main/chapters/probability/13_discr_rv_distr.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-prob/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>