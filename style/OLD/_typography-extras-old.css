/* =========================
   Tipografia classica/umanistica
   ========================= */

/* Misura della riga e ritmo verticale */
.quarto-container .page-layout-article .content {
  max-width: 72ch;
  line-height: 1.55;
}

/* Sillabazione soft (in italiano funziona bene) */
.content p,
.content li,
.content blockquote {
  hyphens: auto;
  -webkit-hyphens: auto;
  -ms-hyphens: auto;
}

/* Vedove e orfani (supporto parziale) */
.content p { orphans: 3; widows: 3; }

/* Leggibilità e kerning (se vuoi, puoi riattivare optimizeLegibility) */
/* html { text-rendering: optimizeLegibility; font-kerning: normal; } */

/* Numeri vecchio stile + proporzionali, small caps “vere” */
body {
  font-variant-numeric: oldstyle-nums proportional-nums;
  font-variant-caps: normal;
}

/* Corsivi più “morbidi”: evita bold eccessivo */
strong { font-weight: 600; }

/* Small caps dedicate */
.sc { font-variant-caps: small-caps; letter-spacing: 0.02em; }

/* Link con sottolineatura elegante */
a {
  text-decoration-thickness: 0.08em;
  text-underline-offset: 0.15em;
  text-decoration-skip-ink: auto;
}

/* Capolettera (lead, p.dropcap, div.dropcap) */
.lead:first-letter,
p.dropcap:first-letter,
.dropcap:first-letter {
  float: left;
  font-size: 3.1em;
  line-height: 0.85;
  margin-right: 0.08em;
  font-feature-settings: "onum" 1, "liga" 1;
}

/* Citazioni più classiche */
blockquote {
  font-style: italic;
  padding-left: 1.2rem;
  border-left: 2px solid currentColor;
  opacity: 0.95;
}

/* Tabelle sobrie e figure “da manuale” */
table {
  border-collapse: collapse;
  font-variant-numeric: tabular-nums; /* allinei numeri */
}
table th, table td { padding: 0.4rem 0.6rem; }
figcaption {
  font-size: 0.95em;
  font-style: italic;
  margin-top: 0.2rem;
  hyphens: none;
}

/* Figure responsive */
.quarto-figure img,
.quarto-figure svg {
  display: block;
  max-width: 100%;
  height: auto;
}

/* Punteggiatura sospesa (hanging punctuation) quando supportata */
.content { hanging-punctuation: first allow-end; }

/* Evita che titoli vadano in fondo pagina da soli in stampa */
@media print {
  h2, h3, h4 { break-after: avoid; break-inside: avoid; }
  figure, table { break-inside: avoid; }
  pre.sourceCode { border-left-color: #000000; } /* hairline visibile in stampa */
}

/* =========================
   MathJax: zona sicura + micro–spaziatura
   ========================= */

/* Zona sicura per MathJax v3 */
mjx-container,
mjx-container * {
  hyphens: none !important;
  hanging-punctuation: none !important;
  font-variant-numeric: normal !important;
  font-kerning: auto !important;
  letter-spacing: 0 !important;
  text-rendering: auto !important;
  line-height: normal !important;
}
mjx-container { text-rendering: optimizeSpeed !important; }
mjx-container svg {
  text-rendering: optimizeSpeed !important;
  shape-rendering: geometricPrecision !important;
}
mjx-container svg text { letter-spacing: 0 !important; }

/* Spazio quando c'è un simbolo con subscript seguito da "(" */
mjx-msub + mjx-mo[texclass="OPEN"],
mjx-msubsup + mjx-mo[texclass="OPEN"],
mjx-munderover + mjx-mo[texclass="OPEN"] { margin-left: 0.08em; }

/* Compatibilità futura via data-mml-node */
mjx-container [data-mml-node="msub"] + mjx-mo[texclass="OPEN"],
mjx-container [data-mml-node="msubsup"] + mjx-mo[texclass="OPEN"] { margin-left: 0.08em; }

/* Variante: parentesi “stretchy” (es. \left() ) */
mjx-msub + mjx-mo[stretchy="true"],
mjx-msubsup + mjx-mo[stretchy="true"],
mjx-munderover + mjx-mo[stretchy="true"] { margin-left: 0.08em; }

/* =========================
   Codice: sobrio, senza fondino, hairline a sinistra
   ========================= */

/* Togli qualunque fondino, sia al wrapper che al <pre> */
div.sourceCode,
pre.sourceCode,
pre.sourceCode > code {
  background: transparent !important;
}

/* “Hairline” a sinistra + padding interno */
pre.sourceCode {
  border-left: 2px solid #00000026;   /* nero ~15% */
  padding-left: 0.85rem;
  margin: 1rem 0;
  overflow-x: auto;                   /* scroll orizzontale se serve */
}

/* Monospazio sobrio e leggibile; niente sillabazione */
pre.sourceCode,
code,
kbd,
samp {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
               "Liberation Mono", "DejaVu Sans Mono", monospace;
  font-size: 0.94em;
  line-height: 1.5;
  hyphens: none;
  -webkit-hyphens: none;
  -ms-hyphens: none;
  tab-size: 4;
}

/* Inline code senza fondino, appena staccato dal testo */
p code, li code, figcaption code, dd code {
  background: transparent;
  border: none;
  padding: 0 0.1em;
}

/* Line numbers (se attivati) più discreti */
pre.numberSource .sourceLine::before { color: #00000059; }

/* Monospazio: Fira Code con legature */
pre.sourceCode,
code,
kbd,
samp {
  font-family: "Fira Code", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
               "Liberation Mono", "DejaVu Sans Mono", monospace;
  font-feature-settings: "calt" 1, "liga" 1;
  font-variant-ligatures: contextual common-ligatures;
}

/* Togli qualunque fondino/bordo anche ai wrapper di Quarto */
.code-with-copy .sourceCode,
.code-with-copy pre,
div.sourceCode,
pre.sourceCode,
pre.sourceCode > code,
.cell-output pre {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
}

/* Mantieni solo la “hairline” a sinistra del blocco <pre> */
pre.sourceCode {
  border-left: 2px solid #00000026;   /* ~15% nero */
  padding-left: 0.85rem;
  margin: 1rem 0;
  overflow-x: auto;
}

/* Inline code: nessun fondino */
p code, li code, figcaption code, dd code {
  background: transparent !important;
  border: none !important;
  padding: 0 0.1em;
}

/* ======= CODE BLOCK: override robusto (Quarto + Bootstrap) ======= */

/* (1) Monospace globale = Fira Code; sfondi/bordi = trasparenti */
:root,
body,
.quarto-light,
.quarto-dark {
  --bs-font-monospace: "Fira Code", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                       "Liberation Mono", "DejaVu Sans Mono", monospace;
  --quarto-font-monospace: var(--bs-font-monospace);
  --quarto-inline-code-bg: transparent;
  --quarto-code-block-bg: transparent;
  --quarto-code-block-border-color: transparent;
  --quarto-code-block-border-radius: 0;
}

/* (2) Togli sfondo/bordo a TUTTI i wrapper che Quarto può generare */
.code-with-copy,
.code-with-filename,
.code-with-copy .sourceCode,
.code-with-filename .sourceCode,
div.sourceCode,
pre.sourceCode,
pre.sourceCode > code,
.cell-output pre,
pre,
code {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  outline: none !important;
  border-radius: 0 !important;
}

/* (3) Mantieni solo la “hairline” sul <pre> del sorgente */
pre.sourceCode {
  border-left: 2px solid #00000026;   /* ~15% nero */
  padding-left: 0.85rem;
  margin: 1rem 0;
  overflow-x: auto;
}

/* (4) Fira Code effettivo + legature (sovrascrive qualsiasi font diretto) */
pre.sourceCode,
code,
kbd,
samp {
  font-family: var(--bs-font-monospace) !important;
  font-feature-settings: "calt" 1, "liga" 1;
  font-variant-ligatures: contextual common-ligatures;
}

/* (5) Inline code senza fondino */
p code, li code, figcaption code, dd code {
  background: transparent !important;
  border: none !important;
  padding: 0 0.1em;
}

/* (6) Numeri di riga più discreti (se attivi) */
pre.numberSource .sourceLine::before { color: #00000059; }


.quarto-container .page-layout-article .content .code-with-copy .sourceCode,
.quarto-container .page-layout-article .content .code-with-filename .sourceCode,
.quarto-container .page-layout-article .content div.sourceCode,
.quarto-container .page-layout-article .content pre.sourceCode {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
}

/* ===== PATCH DEFINITIVO: code-block senza fondino, con sola hairline ===== */

/* 1) Variabili globali (Quarto/Bootstrap) → niente sfondo e bordo per i code-block */
:root,
body,
.quarto-light,
.quarto-dark {
  --bs-code-bg: transparent;
  --quarto-inline-code-bg: transparent;
  --quarto-code-block-bg: transparent;
  --quarto-code-block-border-color: transparent;
  --quarto-code-block-border-radius: 0;
  --quarto-code-bg: transparent;
}

/* 2) Spegni sfondo/bordi su TUTTI i wrapper usati da Quarto attorno al codice */
.quarto-container .page-layout-article .content .cell,
.quarto-container .page-layout-article .content .cell .sourceCode,
.quarto-container .page-layout-article .content .code-with-copy,
.quarto-container .page-layout-article .content .code-with-filename,
.quarto-container .page-layout-article .content .code-with-copy .sourceCode,
.quarto-container .page-layout-article .content .code-with-filename .sourceCode,
.quarto-container .page-layout-article .content .code-with-copy-target,    /* <pre> con questa classe */
.quarto-container .page-layout-article .content div.sourceCode,
.quarto-container .page-layout-article .content pre.sourceCode,
.quarto-container .page-layout-article .content pre.sourceCode > code,
.quarto-container .page-layout-article .content .cell-output pre,
.quarto-container .page-layout-article .content .bg-light                   /* eventuale bg-light del tema */
{
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  outline: none !important;
  border-radius: 0 !important;
}

/* 3) RIATTIVA SOLO la hairline a sinistra sul <pre> del sorgente */
.quarto-container .page-layout-article .content pre.sourceCode,
.quarto-container .page-layout-article .content pre.code-with-copy-target {
  border-left: 2px solid #00000026 !important; /* ~15% nero */
  padding-left: 0.85rem;
  margin: 1rem 0;
  overflow-x: auto;
}

/* 4) Inline code senza fondino (per sicurezza) */
.quarto-container .page-layout-article .content p code,
.quarto-container .page-layout-article .content li code,
.quarto-container .page-layout-article .content figcaption code,
.quarto-container .page-layout-article .content dd code {
  background: transparent !important;
  border: none !important;
  padding: 0 0.1em;
}

/* 5) Fira Code via variabile monospace (legature on) */
pre.sourceCode,
code,
kbd,
samp {
  font-family: var(--bs-font-monospace) !important;
  font-feature-settings: "calt" 1, "liga" 1;
  font-variant-ligatures: contextual common-ligatures;
}

/* 6) In stampa: hairline piena */
@media print {
  .quarto-container .page-layout-article .content pre.sourceCode,
  .quarto-container .page-layout-article .content pre.code-with-copy-target {
    border-left-color: #000000 !important;
  }
}

/* Titoli in stile “umanistico” più arioso */
.content h1, .content h2, .content h3 {
  letter-spacing: 0.01em;
  font-feature-settings: "liga" 1, "kern" 1, "onum" 1;
}

/* Display math: spaziatura e allineamento “da libro” */
mjx-container[jax="SVG"][display="true"] {
  margin: 1.1em 0 1.1em 0 !important; /* più respiro */
}
mjx-container[jax="SVG"] svg { overflow: visible !important; } /* evita tagli di glifi lunghi */

/* Inline code: colore testo coerente e senza grigio Bootstrap */
:root {
  --bs-code-color: inherit;           /* niente blu/grigio per inline code */
  --quarto-inline-code-bg: transparent;
}

/* Link: sottolineatura più “stampata” (già buona, solo leggermente più alta) */
a { text-underline-offset: 0.18em; }

/* Tabelle: tono classico sobrio (coerente con numeri tabular) */
table {
  border-collapse: collapse;
  border: 1px solid #0000001a;
}
table th, table td {
  padding: 0.5rem 0.7rem;
  border-bottom: 1px solid #00000014;
}
table thead th {
  font-variant-caps: small-caps;
  letter-spacing: 0.02em;
}

@media print {
  a { text-decoration: none; } /* stile “libro” su stampa */
  .toc-left, nav.sidebar { display: none !important; } /* se presenti */
}

